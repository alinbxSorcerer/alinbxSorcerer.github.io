<!DOCTYPE html>
<html prefix="" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>读书评注: APUE | A Magic Land Declared by David</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="https://alinbxsorcerer.github.io/posts/dushu-phngzhu-apue/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="David">
<meta property="og:site_name" content="A Magic Land Declared by David">
<meta property="og:title" content="读书评注: APUE">
<meta property="og:url" content="https://alinbxsorcerer.github.io/posts/dushu-phngzhu-apue/">
<meta property="og:description" content="Preface to the First Edition

Introduction
This book describes the programming interface to the Unix system—the system call interface and many of the functions provided in the standard C library. It i">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2018-09-21T20:53:29+08:00">
<meta property="article:tag" content="C">
</head>
<body>
    

    <header id="header" class="navbar"><div class="container">
            
    <div class="brand">

        <div class="brand-text">
            <a href="https://alinbxsorcerer.github.io/" title="A Magic Land Declared by David" rel="home">
                A Magic Land Declared by David
            </a>
        </div>

        <a id="btn-toggle-nav" class="navbar-toggle">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </a>
    </div>

            
    <nav class="navbar-collapse collapse"><ul class="nav">
<li><a href="../../archive.html">Archive</a></li>
                <li><a href="../../categories/">Tags</a></li>
                <li><a href="../../rss.xml">RSS feed</a></li>
    
    
    </ul></nav>
</div>
    </header><div class="header-padding"> </div>

    
    <div class="post-header">
        <div class="container">
            <div class="title">
                读书评注: APUE
            </div>
        </div>
    </div>

    <div class="post-meta">
      <div class="container">
	<div class="meta clearfix">
	  <div class="authordate">
	    <time class="timeago" datetime="2018-09-21T20:53:29+08:00">2018/09/21</time>
	    

	    
          |  
        <a href="index.rst" id="sourcelink">Source</a>

	  </div>
	  <div class="post-tags">
	    <div class="tag">
	      <a href="../../categories/c/" rel="tag">C</a>
	    </div>
	  </div>
	</div>
      </div>
    </div>


    <div id="post-main" class="main">
        <div class="container">
        <div class="section" id="preface-to-the-first-edition">
<h2>Preface to the First Edition</h2>
<div class="section" id="introduction">
<h3>Introduction</h3>
<p>This book describes the programming interface to the Unix system—the system call interface and many of the functions provided in the standard C library. It is intended for anyone writing programs that run under Unix.</p>
<p>Like most operating systems, Unix provides numerous services to the programs that are running—open a file, read a file, start a new program, allocate a region of memory, get the current time-of-day, and so on. This has been termed the <em>system call interface</em>. Additionally, the standard C library provides numerous functions that are used by almost every C program (format a variable's value for output, compare two strings, etc.).</p>
<p>The system call interface and the library routines have traditionally been described in Sections 2 and 3 of the <em>Unix Programmer's Manual</em>. This book is not a duplication of these sections. Examples and rationale are missing from the <em>Unix Programmer's Manual</em>, and that's what this book provides.</p>
</div>
<div class="section" id="unix-standards">
<h3>Unix Standards</h3>
<p>The proliferation of different versions of Unix during the 1980s has been tempered by the various international standards that were started during the late 1980s. These include the ANSI standard for the C programming language, the IEEE POSIX family (still being developed), and the X/Open portability guide.</p>
<p>This book also describes these standards. But instead of just describing the standards by themselves, we describe them in relation to popular implementations of the standards—System V Release 4 and the forthcoming 4.4BSD. This provides a real-world description, which is often lacking from the standard itself and from books that describe only the standard.</p>
</div>
<div class="section" id="organization-of-the-book">
<h3>Organization of the Book</h3>
<p>This book is divided into six parts:</p>
<ol class="arabic simple">
<li><p>An overview and introduction to basic Unix programming concepts and terminology (<a class="reference external" href="part0013.xhtml#ch01">Chapter 1</a>), with a discussion of the various Unix standardization efforts and different Unix implementations (<a class="reference external" href="part0014.xhtml#ch02">Chapter 2</a>).</p></li>
<li><p>I/O—unbuffered I/O (<a class="reference external" href="part0015.xhtml#ch03">Chapter 3</a>), properties of files and directories (<a class="reference external" href="part0016.xhtml#ch04">Chapter 4</a>), the standard I/O library (<a class="reference external" href="part0017.xhtml#ch05">Chapter 5</a>), and the standard system data files (<a class="reference external" href="part0018.xhtml#ch06">Chapter 6</a>).</p></li>
<li><p>Processes—the environment of a Unix process (<a class="reference external" href="part0019.xhtml#ch07">Chapter 7</a>), process control (<a class="reference external" href="part0020.xhtml#ch08">Chapter 8</a>), the relationships between different processes (<a class="reference external" href="part0021.xhtml#ch09">Chapter 9</a>), and signals (<a class="reference external" href="part0022.xhtml#ch10">Chapter 10</a>).</p></li>
<li><p>More I/O—terminal I/O (<a class="reference external" href="part0023.xhtml#ch11">Chapter 11</a>), advanced I/O (<a class="reference external" href="part0024.xhtml#ch12">Chapter 12</a>), and daemon processes (<a class="reference external" href="part0025.xhtml#ch13">Chapter 13</a>).</p></li>
<li><p>IPC—Interprocess communication (<a class="reference external" href="part0026.xhtml#ch14">Chapters 14</a> and <a class="reference external" href="part0027.xhtml#ch15">15</a>).</p></li>
<li><p>Examples—a database library (<a class="reference external" href="part0028.xhtml#ch16">Chapter 16</a>), communicating with a PostScript printer (<a class="reference external" href="part0029.xhtml#ch17">Chapter 17</a>), a modem dialing program (<a class="reference external" href="part0030.xhtml#ch18">Chapter 18</a>), and using pseudo terminals (<a class="reference external" href="part0031.xhtml#ch19">Chapter 19</a>).</p></li>
</ol>
<p>A reading familiarity with C would be beneficial as would some experience using Unix. No prior programming experience with Unix is assumed. This text is intended for programmers familiar with Unix and programmers familiar with some other operating system who wish to learn the details of the services provided by most Unix systems.</p>
</div>
<div class="section" id="examples-in-the-text">
<h3>Examples in the Text</h3>
<p>This book contains many examples—approximately 10,000 lines of source code. All the examples are in the C programming language. Furthermore, these examples are in ANSI C. You should have a copy of the <em>Unix Programmer's Manual</em> for your system handy while reading this book, since reference is made to it for some of the more esoteric and implementation-dependent features.</p>
<p>Almost every function and system call is demonstrated with a small, complete program. This lets us see the arguments and return values and is often easier to comprehend than the use of the function in a much larger program. But since some of the small programs are contrived examples, a few bigger examples are also included (<a class="reference external" href="part0028.xhtml#ch16">Chapters 16</a>, <a class="reference external" href="part0029.xhtml#ch17">17</a>, <a class="reference external" href="part0030.xhtml#ch18">18</a>, and <a class="reference external" href="part0031.xhtml#ch19">19</a>). These larger examples demonstrate the programming techniques in larger, real-world examples.</p>
<p>All the examples have been included in the text directly from their source files. A machine-readable copy of all the examples is available via anonymous FTP from the Internet host <code class="docutils literal">ftp.uu.net</code> in the file <code class="docutils literal">published/books/stevens.advprog.tar.Z</code>. Obtaining the source code allows you to modify the programs from this text and experiment with them on your system.</p>
</div>
<div class="section" id="systems-used-to-test-the-examples">
<h3>Systems Used to Test the Examples</h3>
<p>Unfortunately all operating systems are moving targets. Unix is no exception. The following diagram shows the recent evolution of the various versions of System V and 4.xBSD.</p>
<p><img alt="image0" src="Images/image01287.jpeg"></p>
<p>4.xBSD are the various systems from the Computer Systems Research Group at the University of California at Berkeley. This group also distributes the BSD Net 1 and BSD Net 2 releases—publicly available source code from the 4.xBSD systems. SVRx refers to System V Release x from AT&amp;T. XPG3 is the X/Open Portability Guide, Issue 3, and ANSI C is the ANSI standard for the C programming language. POSIX.1 is the IEEE and ISO standard for the interface to a Unix-like system. We'll have more to say about these different standards and the various versions of Unix in <a class="reference external" href="part0014.xhtml#ch02lev1sec2">Sections 2.2</a> and <a class="reference external" href="part0014.xhtml#ch02lev1sec3">2.3</a>.</p>
<p><strong>In this text we use the term 4.3+BSD to refer to the Unix system from Berkeley that is somewhere between the BSD Net 2 release and 4.4BSD.</strong></p>
<p>At the time of this writing, 4.4BSD was not released, so the system could not be called 4.4BSD. Nevertheless a simple name was needed to refer to this system and <em>4.3+BSD</em> is used throughout the text.</p>
<p>Most of the examples in this text have been run on four different versions of Unix:</p>
<ol class="arabic simple">
<li><p>Unix System V/386 Release 4.0 Version 2.0 (“vanilla SVR4”) from U.H. Corp. (UHC), on an Intel 80386 processor.</p></li>
<li><p>4.3+BSD at the Computer Systems Research Group, Computer Science Division, University of California at Berkeley, on a Hewlett Packard workstation.</p></li>
<li><p>BSD/386 (a derivative of the BSD Net 2 release) from Berkeley Software Design, Inc., on an Intel 80386 processor. This system is almost identical to what we call 4.3+BSD.</p></li>
<li><p>SunOS 4.1.1 and 4.1.2 (systems with a strong Berkeley heritage but many System V features) from Sun Microsystems, on a SPARCstation SLC.</p></li>
</ol>
<p>Numerous timing tests are provided in the text and the systems used for the test are identified.</p>
</div>
<div class="section" id="acknowledgments">
<h3>Acknowledgments</h3>
<p>Once again I am indebted to my family for their love, support, and many lost weekends over the past year and a half. Writing a book is, in many ways, a family affair. Thank you Sally, Bill, Ellen, and David.</p>
<p>I am especially grateful to Brian Kernighan for his help in the book. His numerous thorough reviews of the entire manuscript and his gentle prodding for better prose hopefully show in the final result. Steve Rago was also a great resource, both in reviewing the entire manuscript and answering many questions about the details and history of System V. My thanks to the other technical reviewers used by Addison-Wesley, who provided valuable comments on various portions of the manuscript: Maury Bach, Mark Ellis, Jeff Gitlin, Peter Honeyman, John Linderman, Doug McIlroy, Evi Nemeth, Craig Partridge, Dave Presotto, Gary Wilson, and Gary Wright.</p>
<p>Keith Bostic and Kirk McKusick at the U.C. Berkeley CSRG provided an account that was used to test the examples on the latest BSD system. (Many thanks to Peter Salus too.) Sam Nataros and Joachim Sacksen at UHC provided the copy of SVR4 used to test the examples. Trent Hein helped obtain the alpha and beta copies of BSD/386.</p>
<p>Other friends have helped in many small, but significant ways over the past few years: Paul Lucchina, Joe Godsil, Jim Hogue, Ed Tankus, and Gary Wright. My editor at Addison-Wesley, John Wait, has been a great friend through it all. He never complained when the due date slipped and the page count kept increasing. A special thanks to the National Optical Astronomy Observatories (NOAO), especially Sidney Wolff, Richard Wolff, and Steve Grandi, for providing computer time.</p>
<p><em>Real</em> Unix books are written using troff and this book follows that time-honored tradition. Camera-ready copy of the book was produced by the author using the groff package written by James Clark. Many thanks to James Clark for providing this excellent system and for his rapid response to bug fixes. Perhaps someday I will really understand troff footer traps.</p>
<p>I welcome electronic mail from any readers with comments, suggestions, or bug fixes.</p>
<p><em>Tucson, Arizona</em></p>
<p><em>April 1992</em></p>
<ol class="upperalpha simple" start="23">
<li><p>Richard Stevens</p></li>
</ol>
<p><code class="docutils literal">rstevens@kohala.com</code></p>
<p><code class="docutils literal"><span class="pre">http://www.kohala.com/~rstevens</span></code></p>
</div>
<div class="section" id="publish">
<h3>Publish</h3>
<pre class="code ipython"><a name="rest_code_f4ecce103db24427ac5f222ebb373cab-1"></a><span class="kn">import</span> <span class="nn">glob</span>
<a name="rest_code_f4ecce103db24427ac5f222ebb373cab-2"></a><span class="kn">import</span> <span class="nn">os</span>
<a name="rest_code_f4ecce103db24427ac5f222ebb373cab-3"></a><span class="kn">import</span> <span class="nn">re</span>
<a name="rest_code_f4ecce103db24427ac5f222ebb373cab-4"></a><span class="kn">import</span> <span class="nn">subprocess</span>
<a name="rest_code_f4ecce103db24427ac5f222ebb373cab-5"></a>
<a name="rest_code_f4ecce103db24427ac5f222ebb373cab-6"></a><span class="n">htmls</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">"*.xhtml"</span><span class="p">)</span>
<a name="rest_code_f4ecce103db24427ac5f222ebb373cab-7"></a><span class="c1"># print(htmls)</span>
<a name="rest_code_f4ecce103db24427ac5f222ebb373cab-8"></a><span class="n">htmls</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]))</span>
<a name="rest_code_f4ecce103db24427ac5f222ebb373cab-9"></a>
<a name="rest_code_f4ecce103db24427ac5f222ebb373cab-10"></a><span class="c1"># print(htmls)</span>
<a name="rest_code_f4ecce103db24427ac5f222ebb373cab-11"></a><span class="c1"># for i, e in enumerate(htmls, start=1):</span>
<a name="rest_code_f4ecce103db24427ac5f222ebb373cab-12"></a><span class="c1">#     os.rename(e, f"{i:02}.xhtml")</span>
<a name="rest_code_f4ecce103db24427ac5f222ebb373cab-13"></a>
<a name="rest_code_f4ecce103db24427ac5f222ebb373cab-14"></a><span class="k">for</span> <span class="n">html</span> <span class="ow">in</span> <span class="n">htmls</span><span class="p">:</span>
<a name="rest_code_f4ecce103db24427ac5f222ebb373cab-15"></a>    <span class="n">cmd</span> <span class="o">=</span> <span class="n">f</span><span class="s2">"pandoc --wrap=none {html} -o {re.sub(r'xhtml$', 'org', html)}"</span>
<a name="rest_code_f4ecce103db24427ac5f222ebb373cab-16"></a>    <span class="k">assert</span> <span class="n">cmd</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">"org"</span><span class="p">),</span> <span class="s2">"not ends with org"</span>
<a name="rest_code_f4ecce103db24427ac5f222ebb373cab-17"></a>    <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<a name="rest_code_f4ecce103db24427ac5f222ebb373cab-18"></a>
<a name="rest_code_f4ecce103db24427ac5f222ebb373cab-19"></a><span class="k">print</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">())</span>
</pre>
<pre class="code ipython"><a name="rest_code_42a458cdb4a048c2aad005b5b9553ad0-1"></a><span class="o">!</span>ls
</pre>
<pre class="code ipython"><a name="rest_code_b4f8a7e6eb45450292969609ba85de3d-1"></a><span class="o">!</span>pandoc --wrap<span class="o">=</span>none <span class="m">00</span>.Preface.org -o ~/Public/nikola_post/posts/读书评注:APUE.rst
</pre>
</div>
<div class="section" id="clean-chapters">
<h3>Clean Chapters</h3>
<pre class="code ipython"><a name="rest_code_221e705ea00341eb9e070f0275d0e0ef-1"></a><span class="kn">import</span> <span class="nn">re</span>
<a name="rest_code_221e705ea00341eb9e070f0275d0e0ef-2"></a><span class="kn">import</span> <span class="nn">glob</span>
<a name="rest_code_221e705ea00341eb9e070f0275d0e0ef-3"></a>
<a name="rest_code_221e705ea00341eb9e070f0275d0e0ef-4"></a>
<a name="rest_code_221e705ea00341eb9e070f0275d0e0ef-5"></a><span class="k">def</span> <span class="nf">clearup</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
<a name="rest_code_221e705ea00341eb9e070f0275d0e0ef-6"></a>    <span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">"r+"</span><span class="p">)</span>
<a name="rest_code_221e705ea00341eb9e070f0275d0e0ef-7"></a>    <span class="n">text</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<a name="rest_code_221e705ea00341eb9e070f0275d0e0ef-8"></a>    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">"</span><span class="se">\\</span><span class="s2">"</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<a name="rest_code_221e705ea00341eb9e070f0275d0e0ef-9"></a>    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">"&lt;&lt;.+&gt;&gt;"</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<a name="rest_code_221e705ea00341eb9e070f0275d0e0ef-10"></a>    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">".*:PROPERTIES:.*\n.*:CUSTOM_ID:.*\n.*:END:.*"</span><span class="p">,</span> <span class="s2">""</span><span class="p">,</span>
<a name="rest_code_221e705ea00341eb9e070f0275d0e0ef-11"></a>            <span class="n">text</span><span class="p">)</span>
<a name="rest_code_221e705ea00341eb9e070f0275d0e0ef-12"></a>
<a name="rest_code_221e705ea00341eb9e070f0275d0e0ef-13"></a>    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">"\*(\d\.\d)\*"</span><span class="p">,</span> <span class="s2">"\g&lt;1&gt;"</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<a name="rest_code_221e705ea00341eb9e070f0275d0e0ef-14"></a>    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">"\[\[.*Click here to view code image.*\]"</span><span class="p">,</span>   <span class="s2">""</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<a name="rest_code_221e705ea00341eb9e070f0275d0e0ef-15"></a>    <span class="n">text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">"\*\[\[.*\]\[([0-9]\.[0-9]*)\]\]\*"</span><span class="p">,</span> <span class="s2">"\g&lt;1&gt;"</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<a name="rest_code_221e705ea00341eb9e070f0275d0e0ef-16"></a>    <span class="c1"># print(text[:100])</span>
<a name="rest_code_221e705ea00341eb9e070f0275d0e0ef-17"></a>    <span class="n">fp</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a name="rest_code_221e705ea00341eb9e070f0275d0e0ef-18"></a>    <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<a name="rest_code_221e705ea00341eb9e070f0275d0e0ef-19"></a>    <span class="n">fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<a name="rest_code_221e705ea00341eb9e070f0275d0e0ef-20"></a>
<a name="rest_code_221e705ea00341eb9e070f0275d0e0ef-21"></a><span class="n">clearup</span><span class="p">(</span><span class="s2">"07.org"</span><span class="p">)</span>
<a name="rest_code_221e705ea00341eb9e070f0275d0e0ef-22"></a>
<a name="rest_code_221e705ea00341eb9e070f0275d0e0ef-23"></a><span class="c1"># orgs = glob.glob("*.org")</span>
</pre>
<pre class="code ipython"><a name="rest_code_c710ee9d7f68403da3f410e75ac07176-1"></a><span class="kn">import</span> <span class="nn">glob</span>
<a name="rest_code_c710ee9d7f68403da3f410e75ac07176-2"></a>
<a name="rest_code_c710ee9d7f68403da3f410e75ac07176-3"></a>
<a name="rest_code_c710ee9d7f68403da3f410e75ac07176-4"></a><span class="n">orgs</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">"*.org"</span><span class="p">)</span>
<a name="rest_code_c710ee9d7f68403da3f410e75ac07176-5"></a><span class="n">orgs</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">(),</span> <span class="n">orgs</span><span class="p">)</span>
<a name="rest_code_c710ee9d7f68403da3f410e75ac07176-6"></a><span class="n">orgs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">orgs</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">])[</span><span class="mi">10</span><span class="p">:]</span>
<a name="rest_code_c710ee9d7f68403da3f410e75ac07176-7"></a><span class="c1"># orgs.sort(key=lambda x: int(x[0:2]))</span>
<a name="rest_code_c710ee9d7f68403da3f410e75ac07176-8"></a>
<a name="rest_code_c710ee9d7f68403da3f410e75ac07176-9"></a><span class="k">for</span> <span class="n">org</span> <span class="ow">in</span> <span class="n">orgs</span><span class="p">:</span>
<a name="rest_code_c710ee9d7f68403da3f410e75ac07176-10"></a>    <span class="n">clearup</span><span class="p">(</span><span class="n">org</span><span class="p">)</span>
</pre>
</div>
<div class="section" id="add-chapter-names">
<h3>Add chapter names</h3>
<pre class="code ipython"><a name="rest_code_4ab1836458da46fea2525054b95485ad-1"></a><span class="k">print</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
<a name="rest_code_4ab1836458da46fea2525054b95485ad-2"></a><span class="kn">import</span> <span class="nn">glob</span>
<a name="rest_code_4ab1836458da46fea2525054b95485ad-3"></a><span class="kn">import</span> <span class="nn">os</span>
<a name="rest_code_4ab1836458da46fea2525054b95485ad-4"></a>
<a name="rest_code_4ab1836458da46fea2525054b95485ad-5"></a><span class="n">orgs</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">"*.org"</span><span class="p">)</span>
<a name="rest_code_4ab1836458da46fea2525054b95485ad-6"></a><span class="n">orgs</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>
<a name="rest_code_4ab1836458da46fea2525054b95485ad-7"></a><span class="n">orgs</span> <span class="o">=</span> <span class="n">orgs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">23</span><span class="p">]</span>
<a name="rest_code_4ab1836458da46fea2525054b95485ad-8"></a>
<a name="rest_code_4ab1836458da46fea2525054b95485ad-9"></a>
<a name="rest_code_4ab1836458da46fea2525054b95485ad-10"></a><span class="k">for</span> <span class="n">old</span><span class="p">,</span> <span class="n">new</span> <span class="ow">in</span> <span class="n">td</span><span class="p">:</span>
<a name="rest_code_4ab1836458da46fea2525054b95485ad-11"></a>    <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span>
<a name="rest_code_4ab1836458da46fea2525054b95485ad-12"></a>
<a name="rest_code_4ab1836458da46fea2525054b95485ad-13"></a><span class="k">print</span><span class="p">(</span><span class="n">orgs</span><span class="p">)</span>
</pre>
<pre class="code ipython"><a name="rest_code_216155509d3841cf8d71499601f8b35e-1"></a><span class="c1"># 忘记加后缀名</span>
<a name="rest_code_216155509d3841cf8d71499601f8b35e-2"></a><span class="c1"># ! rm *.xhtml</span>
<a name="rest_code_216155509d3841cf8d71499601f8b35e-3"></a><span class="n">fs</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">()</span>
<a name="rest_code_216155509d3841cf8d71499601f8b35e-4"></a><span class="n">fs</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">"org"</span><span class="p">),</span> <span class="n">fs</span><span class="p">)</span>
<a name="rest_code_216155509d3841cf8d71499601f8b35e-5"></a><span class="k">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">fs</span><span class="p">))</span>
<a name="rest_code_216155509d3841cf8d71499601f8b35e-6"></a><span class="c1"># map(lambda x: os.rename(x, f"{x}.org"), fs)</span>
<a name="rest_code_216155509d3841cf8d71499601f8b35e-7"></a><span class="o">!</span> ls
<a name="rest_code_216155509d3841cf8d71499601f8b35e-8"></a><span class="c1"># print(fs)</span>
</pre>
<pre class="code ipython"><a name="rest_code_2258d7a1f3a64e139906c7a629ac8fc4-1"></a><span class="kn">import</span> <span class="nn">os</span>
<a name="rest_code_2258d7a1f3a64e139906c7a629ac8fc4-2"></a><span class="kn">import</span> <span class="nn">glob</span>
<a name="rest_code_2258d7a1f3a64e139906c7a629ac8fc4-3"></a><span class="kn">import</span> <span class="nn">copy</span>
<a name="rest_code_2258d7a1f3a64e139906c7a629ac8fc4-4"></a>
<a name="rest_code_2258d7a1f3a64e139906c7a629ac8fc4-5"></a><span class="n">fs</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">()</span>
<a name="rest_code_2258d7a1f3a64e139906c7a629ac8fc4-6"></a><span class="n">fs</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">"org"</span><span class="p">),</span> <span class="n">fs</span><span class="p">)</span>
<a name="rest_code_2258d7a1f3a64e139906c7a629ac8fc4-7"></a><span class="n">fsc</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">fs</span><span class="p">)</span>
<a name="rest_code_2258d7a1f3a64e139906c7a629ac8fc4-8"></a><span class="k">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">fsc</span><span class="p">)[:</span><span class="mi">5</span><span class="p">])</span>
<a name="rest_code_2258d7a1f3a64e139906c7a629ac8fc4-9"></a><span class="c1">#</span>
</pre>
<pre class="code ipython"><a name="rest_code_5bb8b242a29b485aacd979f390b5d32e-1"></a><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="s1">'.org'</span><span class="p">),</span> <span class="n">fs</span><span class="p">)</span>
<a name="rest_code_5bb8b242a29b485aacd979f390b5d32e-2"></a><span class="o">!</span> ls <span class="p">|</span> head -n <span class="m">5</span>
</pre>
<pre class="code ipython"><a name="rest_code_861f741d8056483083ab005aaef37d4d-1"></a><span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">fs</span><span class="p">:</span>
<a name="rest_code_861f741d8056483083ab005aaef37d4d-2"></a>    <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">f</span><span class="s2">"{f}.org"</span><span class="p">)</span>
<a name="rest_code_861f741d8056483083ab005aaef37d4d-3"></a><span class="o">!</span> ls <span class="p">|</span> head -n <span class="m">5</span>
</pre>
</div>
</div>
            
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="?",
            disqus_url="https://alinbxsorcerer.github.io/posts/dushu-phngzhu-apue/",
        disqus_title="\u8bfb\u4e66\u8bc4\u6ce8: APUE",
        disqus_identifier="cache/posts/读书评注:APUE.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        

        </div>
    </div>

    
    <footer><div class="container">
            <div class="social">



                <div class="social-entry">
                    <a href="../../rss.xml" target="_blank">
                        <i class="fa fa-rss"></i> 
                    </a>
                </div>
            </div>
                <div class="copyright">
                    Contents © 2019         <a href="mailto:davad.fhl.wang@foxmail.com">David</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
                    
                </div>
           
        </div>
    </footer><script src="../../assets/js/all-nocdn.js" type="text/javascript"></script>
</body>
</html>
