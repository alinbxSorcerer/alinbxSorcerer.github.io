<!DOCTYPE html>
<html prefix="" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>评注:SQL in 10 Minutes 总结 | A Magic Land Declared by David</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="https://alinbxsorcerer.github.io/posts/sql-in-10-minutes/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="David">
<meta property="og:site_name" content="A Magic Land Declared by David">
<meta property="og:title" content="评注:SQL in 10 Minutes 总结">
<meta property="og:url" content="https://alinbxsorcerer.github.io/posts/sql-in-10-minutes/">
<meta property="og:description" content="Introduction
This book was born out of necessity.
I had been teaching Web application development for several years, and students were constantly asking for SQL book recommendations. There are lots of">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2017-11-09T20:53:29+08:00">
<meta property="article:tag" content="sql">
<meta property="article:tag" content="评注笔记">
</head>
<body>
    

    <header id="header" class="navbar"><div class="container">
            
    <div class="brand">

        <div class="brand-text">
            <a href="https://alinbxsorcerer.github.io/" title="A Magic Land Declared by David" rel="home">
                A Magic Land Declared by David
            </a>
        </div>

        <a id="btn-toggle-nav" class="navbar-toggle">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </a>
    </div>

            
    <nav class="navbar-collapse collapse"><ul class="nav">
<li><a href="../../archive.html">Archive</a></li>
                <li><a href="../../categories/">Tags</a></li>
                <li><a href="../../rss.xml">RSS feed</a></li>
    
    
    </ul></nav>
</div>
    </header><div class="header-padding"> </div>

    
    <div class="post-header">
        <div class="container">
            <div class="title">
                评注:SQL in 10 Minutes 总结
            </div>
        </div>
    </div>

    <div class="post-meta">
      <div class="container">
	<div class="meta clearfix">
	  <div class="authordate">
	    <time class="timeago" datetime="2017-11-09T20:53:29+08:00">2017/11/09</time>
	    

	    
          |  
        <a href="index.rst" id="sourcelink">Source</a>

	  </div>
	  <div class="post-tags">
	    <div class="tag">
	      <a href="../../categories/sql/" rel="tag">sql</a>
	    </div>
	    <div class="tag">
	      <a href="../../categories/ping-zhu-bi-ji/" rel="tag">评注笔记</a>
	    </div>
	  </div>
	</div>
      </div>
    </div>


    <div id="post-main" class="main">
        <div class="container">
        <div>
<div class="section" id="introduction">
<h2>Introduction</h2>
<p>This book was born out of necessity.</p>
<p>I had been teaching Web application development for several years, and students were constantly asking for SQL book recommendations. There are lots of SQL books out there. Some are actually very good. But they all have one thing in common: for most users they teach just too much information. Instead of teaching SQL itself, most books teach everything from database design and normalization to relational database theory and administrative concerns. And while those are all important topics, they are not of interest to most of us who just need to learn SQL. And so, not finding a single book that I felt comfortable recommending, I turned that classroom experience into the book you are holding. Sams Teach Yourself SQL in 10 Minutes will teach you SQL you need to know, starting with simple data retrieval and working on to more complex topics including the use of joins, subqueries, stored procedures, cursors, ??triggers, and table constraints. You’ll learn methodically, systematically, and simply—in lessons that will each take 10 minutes or less to complete. Now in its fourth edition, this book has taught SQL to over a quarter million English speaking users, and has been translated into over a dozen other languages too so as to help users the globe over. And now it is your turn. So turn to Lesson 1, and get to work. You’ll be writing world class SQL in no time at all.</p>
<div class="section" id="dbmss-covered-in-this-book">
<h3>DBMSs Covered in This Book</h3>
<p>For the most part, the SQL taught in this book will apply to any Database Management System (DBMS). However, as all SQL implementations are not created equal,</p>
<p>the following DBMSs are explicitly covered (and specific instructions or notes are included where needed): • Apache Open Office Base • IBM DB2 • Microsoft Access • Microsoft SQL Server (including Microsoft SQL Server Express) • MariaDB • MySQL • Oracle (including Oracle Express) • PostgreSQL • SQLite Example databases (or SQL scripts to create the example databases) are available for all of these DBMSs on the book webpage at <a class="reference external" href="http://forta.com/books/0672336073/">http://forta.com/books/0672336073/</a> Errors: <a class="reference external" href="https://forta.com/books/0672336073/errata/">https://forta.com/books/0672336073/errata/</a></p>
</div>
</div>
<div class="section" id="understanding-sql">
<h2>1 Understanding SQL</h2>
<p>总结 database, table, column, row, primary key</p>
<div class="section" id="databases">
<h3>Databases</h3>
<p>The term database is used in many different ways, but for our purposes (and indeed, from SQL’s perspective) a database is a collection of data stored in some organized fashion. The simplest way to think of it is to imagine a database as a filing cabinet. The filing cabinet is simply a physical location to store data, regardless of what that data is or how it is organized.</p>
<blockquote>
<p>Database</p>
<p>A container (usually a file or set of files) to store organized data.</p>
<p>Caution: Misuse Causes Confusion</p>
<p>People often use the term database to refer to the database software they are running. This is incorrect, and it is a source of much confusion. Database software is actually called the Database Management System (or DBMS). The database is the container created and manipulated via the DBMS, and exactly what the database is and what form it takes varies from one database to the next.</p>
</blockquote>
</div>
<div class="section" id="tables">
<h3>Tables</h3>
<p>When you store information in your filing cabinet, you don’t just {phase:toss it in a drawer}. Rather, you create files within the filing cabinet, and then you file related data in specific files.</p>
<p>In the database world, that file is called a table. A table is a structured file that can store data of a specific type. A table might contain a list of customers, a product catalog, or any other list of information.</p>
<blockquote>
<p>Table is a file A structured list of data of a specific type.</p>
</blockquote>
<p>The key here is that the data stored in the table is one type of data or one list. You would never store a list of customers and a list of orders in the same database table. Doing so would make subsequent retrieval and access difficult. Rather, you’d create two tables, one for each list.</p>
<p>Every table in a database has a name that identifies it. That name is always unique— meaning no other table in that database can have the same name.</p>
<blockquote>
<p>Note: Table Names</p>
<p>What makes a table name unique is actually a combination of several things including the database name and table name. Some databases also use the name of the database owner as part of the unique name. This means that while you cannot use the same table name twice in the same database, you definitely can reuse table names in different databases.</p>
</blockquote>
<p>Tables have characteristics and properties that define how data is stored in them. These include information about what data may be stored, how it is broken up, how individual pieces of information are named, and much more. This set of information that describes a table is known as a schema, and schemas are used to describe specific tables within a database, as well as entire databases (and the relationship between tables in them, if any).</p>
<blockquote>
<p>Schema</p>
<p>Information about database and table layout and properties.</p>
</blockquote>
</div>
<div class="section" id="columns-and-datatypes-field">
<h3>Columns and Datatypes Field</h3>
<p>Tables are made up of columns. A column contains a particular piece of information within a table.</p>
<p>Column A single field in a table. All tables are made up of one or more columns.</p>
<p>The best way to understand this is to envision database tables as grids, somewhat like spreadsheets. Each column in the grid contains a particular piece of information. In a customer table, for example, one column contains the customer number, another contains the customer name, and the address, city, state, and ZIP code are all stored in their own columns.</p>
<p>Tip: Breaking Up Data It is extremely important to break data into multiple columns correctly. For example, city, state, and ZIP code should always be separate columns. By breaking these out, it becomes possible to sort or filter data by specific columns (for example, to find all customers in a particular state or in a particular city). If city and state are combined into one column, it would be extremely difficult to sort or filter by state.</p>
<p>When you break up data, the level of granularity is up to you and your specific requirements. For example, addresses are typically stored with the house number and street name together. This is fine, unless you might one day need to sort data by street name, in which case splitting house number and street name would be preferable.</p>
<p>Each column in a database has an associated datatype. A datatype defines what type of data the column can contain. For example, if the column were to contain a number(perhaps the number of items in an order), the datatype would be a numeric datatype. If the column were to contain dates, text, notes, currency amounts, and so on, the appropriate datatype would be used to specify this.</p>
<p>Datatype</p>
<p>A type of allowed data. Every table column has an associated datatype that restricts (or allows) specific data in that column.</p>
<p>Datatypes restrict the type of data that can be stored in a column (for example, preventing the entry of alphabetical characters into a numeric field). Datatypes also help sort data correctly and play an important role in optimizing disk usage. As such, special attention must be given to picking the right datatype when tables are created.</p>
<p>Caution: Datatype Compatibility</p>
<p>Datatypes and their names are one of the primary sources of SQL incompatibility. While most basic datatypes are supported consistently, many more advanced datatypes are not. And worse, occasionally you’ll find that the same datatype is referred to by different names in different DBMSs. There is not much you can do about this, but it is important to keep in mind when you create table schemas.</p>
</div>
<div class="section" id="rows-record">
<h3>Rows record</h3>
<p>Data in a table is stored in rows; each record saved is stored in its own row. Again, envisioning a table as a spreadsheet style grid, the vertical columns in the grid are the table columns, and the horizontal rows are the table rows.</p>
<p>For example, a customers table might store one customer per row. The number of rows in the table is the number of records in it.</p>
<p>Rows A record in a table. Note: Records or Rows?</p>
<p>You may hear users refer to database records when referring to rows. For the most part the two terms are used interchangeably, but row is technically the correct term.</p>
</div>
<div class="section" id="primary-keys">
<h3>Primary Keys</h3>
<p>Every row in a table should have some column (or set of columns) that uniquely identifies it. A table containing customers might use a customer number column for this purpose, whereas a table containing orders might use the order ID. An employee list table might use an employee ID or the employee Social Security number column.</p>
<p>Primary key</p>
<p>A column (or set of columns) whose values uniquely identify every row in a table.</p>
<p>This column (or set of columns) that uniquely identifies each row in a table is called a primary key. The primary key is used to refer to a specific row. Without a primary key, updating or deleting specific rows in a table becomes extremely difficult as there is no guaranteed safe way to refer to just the rows to be affected.</p>
<p>Tip: Always Define Primary Keys</p>
<p>Although primary keys are not actually required, most database designers ensure that every table they create has a primary key so that future data manipulation is possible and manageable.</p>
<p>Any column in a table can be established as the primary key, as long as it meets the following conditions:</p>
<ol class="arabic simple">
<li><p>No two rows can have the same primary key value.</p></li>
<li><p>Every row must have a primary key value. (Primary key columns may not allow NULL values.)</p></li>
<li><p>Values in primary key columns should never be modified or updated.</p></li>
<li><p>Primary key values should never be reused. (If a row is deleted from the table, its primary key may not be assigned to any new rows in the future.)</p></li>
</ol>
<p>Primary keys are usually defined on a single column within a table. But this is not required, and multiple columns may be used together as a primary key. When multiple columns are used, the rules listed above must apply to all columns, and the values of all columns together must be unique (individual columns need not have unique values).</p>
<p>There is another very important type of key called a foreign key, but I’ll get to that later on in Lesson 12, “Joining Tables.”</p>
</div>
</div>
<div class="section" id="retrieving-data">
<h2>2 Retrieving Data</h2>
<p>总结: select, retrieve individual, multiple, all 概念: distinct limit, offset</p>
<div class="section" id="retrieving-individual-column">
<h3>Retrieving Individual Column</h3>
<pre class="code sql"><a name="rest_code_452629943143440aa59f41147b05159d-1"></a><span class="k">select</span> <span class="n">prod_name</span> <span class="k">from</span> <span class="n">Products</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="retrieving-multiple-columns">
<h3>Retrieving Multiple Columns</h3>
<pre class="code sql"><a name="rest_code_35b66a316c444914b88c713d14197c32-1"></a><span class="k">select</span> <span class="n">prod_id</span><span class="p">,</span> <span class="n">prod_name</span><span class="p">,</span> <span class="n">prod_price</span> <span class="k">from</span> <span class="n">Products</span><span class="p">;</span>
<a name="rest_code_35b66a316c444914b88c713d14197c32-2"></a><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">Products</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="retrieving-all-columns">
<h3>Retrieving All Columns</h3>
<pre class="code sql"><a name="rest_code_b650ad804685459bbb93f31b0783378a-1"></a><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">Products</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="retrieving-distinct-column">
<h3>Retrieving Distinct Column</h3>
<pre class="code sql"><a name="rest_code_ef42a9eb2920413ca7d6ac45a4d15709-1"></a><span class="k">select</span> <span class="n">vend_id</span> <span class="k">from</span> <span class="n">Products</span><span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_395fcfbc961543efbceee44cd183e4e5-1"></a><span class="k">select</span> <span class="k">distinct</span> <span class="n">vend_id</span> <span class="k">from</span> <span class="n">Products</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="limiting-results">
<h3>Limiting Results</h3>
<pre class="code sql"><a name="rest_code_a037974d45304ef69b0aab921fe6e297-1"></a><span class="k">select</span> <span class="n">prod_name</span> <span class="k">from</span> <span class="n">Products</span>  <span class="k">limit</span> <span class="mi">5</span><span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_590c87b1e0ef4bf885de9f36d30884a2-1"></a><span class="k">select</span> <span class="n">prod_name</span> <span class="k">from</span> <span class="n">Products</span> <span class="k">limit</span> <span class="mi">5</span> <span class="k">offset</span> <span class="mi">5</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="using-comments">
<h3>Using Comments</h3>
<pre class="code sql"><a name="rest_code_0fef8583f04b497d8f4177032e25e922-1"></a><span class="k">SELECT</span> <span class="n">prod_name</span> <span class="c1">-- this is a comment FROM Products;</span>
</pre>
</div>
</div>
<div class="section" id="sorting-retrieved-data">
<h2>3.Sorting Retrieved Data</h2>
<p>In this lesson, you will learn how to use the SELECT statement's ORDER BY clause to sort retrieved data as needed.</p>
<p>关键词 <code class="docutils literal">order by</code>, 需要放置到最后 individual columm, multiple columns, column postion, sort direction 接在retrieve之后.</p>
<div class="section" id="sorting-data">
<h3>Sorting Data</h3>
<pre class="code sql"><a name="rest_code_bc2b546486b74f8f9936610a9575da11-1"></a><span class="k">select</span> <span class="n">prod_name</span> <span class="k">from</span> <span class="n">Products</span> <span class="k">order</span> <span class="k">by</span> <span class="n">prod_name</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="sorting-by-multiple-columns">
<h3>Sorting by Multiple Columns</h3>
<pre class="code sql"><a name="rest_code_4c49d5eda586420983f3a2cac4390147-1"></a><span class="k">select</span> <span class="n">prod_id</span><span class="p">,</span> <span class="n">prod_price</span><span class="p">,</span> <span class="n">prod_name</span>
<a name="rest_code_4c49d5eda586420983f3a2cac4390147-2"></a><span class="k">from</span> <span class="n">Products</span>
<a name="rest_code_4c49d5eda586420983f3a2cac4390147-3"></a><span class="k">order</span> <span class="k">by</span> <span class="n">prod_price</span><span class="p">,</span> <span class="n">prod_name</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="sorting-by-column-position">
<h3>Sorting by Column Position</h3>
<pre class="code sql"><a name="rest_code_c4e261a43cc845d7999994f81452b2a3-1"></a><span class="k">select</span> <span class="n">prod_id</span><span class="p">,</span> <span class="n">prod_price</span><span class="p">,</span> <span class="n">prod_name</span> <span class="k">from</span> <span class="n">Products</span> <span class="k">order</span> <span class="k">by</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="specifying-sort-direction">
<h3>Specifying Sort Direction</h3>
<pre class="code sql"><a name="rest_code_ebfbf72392c344ec9975ba12cb705ea6-1"></a><span class="k">select</span> <span class="n">prod_id</span><span class="p">,</span> <span class="n">prod_price</span><span class="p">,</span> <span class="n">prod_name</span>
<a name="rest_code_ebfbf72392c344ec9975ba12cb705ea6-2"></a><span class="k">from</span> <span class="n">Products</span>
<a name="rest_code_ebfbf72392c344ec9975ba12cb705ea6-3"></a><span class="k">order</span> <span class="k">by</span> <span class="n">prod_price</span> <span class="k">desc</span><span class="p">,</span> <span class="n">prod_name</span> <span class="k">desc</span><span class="p">;</span>
</pre>
</div>
</div>
<div class="section" id="filtering-data">
<h2>4.Filtering Data</h2>
<p>总结, 开始filter filter, where clause, single value; nonmatches, a range(between), null</p>
<div class="section" id="using-the-where-clause">
<h3>Using the WHERE Clause</h3>
<p>select prod<sub>name</sub>, prod<sub>price</sub> from Products where prod<sub>price</sub> &gt; 3.49</p>
<p>#+end<sub>src</sub></p>
</div>
<div class="section" id="the-where-clause-operators">
<h3>The WHERE Clause Operators</h3>
<div class="figure">
<img alt="Screen Shot 2018-08-11 at 10.03.13 PM" src="http://heropublic.oss-cn-beijing.aliyuncs.com/140327.png"><p class="caption">Screen Shot 2018-08-11 at 10.03.13 PM</p>
</div>
<div class="section" id="checking-against-a-single-value">
<h4>Checking Against a Single Value</h4>
<pre class="code sql"><a name="rest_code_0bfcddbc90224d29be356bfdc267eb77-1"></a><span class="k">select</span> <span class="n">prod_name</span><span class="p">,</span> <span class="n">prod_price</span>
<a name="rest_code_0bfcddbc90224d29be356bfdc267eb77-2"></a><span class="k">from</span> <span class="n">Products</span>
<a name="rest_code_0bfcddbc90224d29be356bfdc267eb77-3"></a><span class="k">where</span> <span class="n">prod_price</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="checking-for-nonmatches">
<h4>Checking for Nonmatches</h4>
<pre class="code sql"><a name="rest_code_900c6a2aae4543fdacb821cca6e1a863-1"></a><span class="k">select</span> <span class="n">vend_id</span><span class="p">,</span> <span class="n">prod_name</span> <span class="k">from</span> <span class="n">Products</span> <span class="k">where</span> <span class="n">vend_id</span> <span class="o">!=</span> <span class="ss">"DLL01"</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="checking-for-a-range-of-values">
<h4>Checking for a Range of Values</h4>
<pre class="code sql"><a name="rest_code_4c2bbc8697a74037b5d4381425a1b242-1"></a><span class="k">select</span> <span class="n">prod_name</span><span class="p">,</span> <span class="n">prod_price</span> <span class="k">from</span> <span class="n">Products</span> <span class="k">where</span> <span class="n">prod_price</span> <span class="k">between</span> <span class="mi">3</span><span class="p">.</span><span class="mi">49</span> <span class="k">and</span> <span class="mi">11</span><span class="p">.</span><span class="mi">99</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="checking-for-no-value">
<h4>Checking for No Value</h4>
<pre class="code sql"><a name="rest_code_0302910743584286b1ab3a7632d0a9bd-1"></a><span class="k">select</span> <span class="n">prod_name</span>
<a name="rest_code_0302910743584286b1ab3a7632d0a9bd-2"></a><span class="k">from</span> <span class="n">Products</span>
<a name="rest_code_0302910743584286b1ab3a7632d0a9bd-3"></a><span class="k">where</span> <span class="n">prod_price</span> <span class="k">is</span> <span class="k">null</span><span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_74c97e0bc1c84722beabc9b81a80ba0f-1"></a><span class="k">select</span> <span class="n">cust_name</span>
<a name="rest_code_74c97e0bc1c84722beabc9b81a80ba0f-2"></a><span class="k">from</span> <span class="n">Customers</span>
<a name="rest_code_74c97e0bc1c84722beabc9b81a80ba0f-3"></a><span class="k">where</span> <span class="n">cust_email</span> <span class="k">is</span> <span class="k">null</span><span class="p">;</span>
</pre>
</div>
</div>
</div>
<div class="section" id="advanced-data-filtering">
<h2>5.Advanced Data Filtering</h2>
<p>总结: 从关键词combine出发. and, or, () which indicate order of evaluation. use in(memberp), not</p>
<div class="section" id="combining-where-clauses">
<h3>Combining WHERE Clauses</h3>
<div class="section" id="using-the-and-operator">
<h4>Using the AND Operator</h4>
<pre class="code sql"><a name="rest_code_b16f20de7dcc42b7af5733b4afb0df42-1"></a><span class="k">select</span> <span class="n">prod_id</span><span class="p">,</span> <span class="n">prod_price</span><span class="p">,</span> <span class="n">prod_name</span>
<a name="rest_code_b16f20de7dcc42b7af5733b4afb0df42-2"></a><span class="k">from</span> <span class="n">Products</span>
<a name="rest_code_b16f20de7dcc42b7af5733b4afb0df42-3"></a><span class="k">where</span> <span class="n">vend_id</span> <span class="o">=</span> <span class="ss">"DLL01"</span> <span class="k">and</span> <span class="n">prod_price</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="using-the-or-operator">
<h4>Using the OR Operator</h4>
<pre class="code sql"><a name="rest_code_b6cdaddb2e6b411c978afdc83da09b06-1"></a><span class="k">select</span> <span class="n">vend_id</span><span class="p">,</span> <span class="n">prod_name</span><span class="p">,</span> <span class="n">prod_price</span>
<a name="rest_code_b6cdaddb2e6b411c978afdc83da09b06-2"></a><span class="k">from</span> <span class="n">Products</span>
<a name="rest_code_b6cdaddb2e6b411c978afdc83da09b06-3"></a><span class="k">where</span> <span class="n">vend_id</span><span class="o">=</span><span class="ss">"DLL01"</span> <span class="k">or</span> <span class="n">vend_id</span> <span class="o">=</span> <span class="ss">"BRS01"</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="understanding-order-of-evaluation">
<h4>Understanding Order of Evaluation</h4>
<pre class="code sql"><a name="rest_code_4cd213d24b9a4e92b597438463ccfc29-1"></a><span class="k">select</span> <span class="n">vend_id</span><span class="p">,</span> <span class="n">prod_name</span><span class="p">,</span> <span class="n">prod_price</span>
<a name="rest_code_4cd213d24b9a4e92b597438463ccfc29-2"></a><span class="k">from</span> <span class="n">Products</span>
<a name="rest_code_4cd213d24b9a4e92b597438463ccfc29-3"></a><span class="k">where</span> <span class="n">vend_id</span> <span class="o">=</span> <span class="ss">"DLL01"</span> <span class="k">or</span> <span class="n">vend_Id</span> <span class="o">=</span> <span class="ss">"BRS01"</span> <span class="k">and</span> <span class="n">prod_price</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_4a8e4f3c3e61471da3cc14695d523a93-1"></a><span class="k">select</span> <span class="n">vend_id</span><span class="p">,</span> <span class="n">prod_name</span><span class="p">,</span> <span class="n">prod_price</span>
<a name="rest_code_4a8e4f3c3e61471da3cc14695d523a93-2"></a><span class="k">from</span> <span class="n">Products</span>
<a name="rest_code_4a8e4f3c3e61471da3cc14695d523a93-3"></a><span class="k">where</span> <span class="p">(</span><span class="n">vend_id</span> <span class="o">=</span> <span class="ss">"DLL01"</span> <span class="k">or</span> <span class="n">vend_id</span> <span class="o">=</span> <span class="ss">"BRS01"</span><span class="p">)</span> <span class="k">and</span> <span class="n">prod_price</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">;</span>
</pre>
</div>
</div>
<div class="section" id="using-the-in-operator">
<h3>Using the IN Operator</h3>
<pre class="code sql"><a name="rest_code_c19ac7132e3b449e846484626f5c9c08-1"></a><span class="k">select</span> <span class="n">prod_name</span><span class="p">,</span> <span class="n">prod_price</span> <span class="k">from</span> <span class="n">Products</span> <span class="k">where</span> <span class="n">vend_id</span> <span class="k">in</span> <span class="p">(</span><span class="ss">"dll01"</span><span class="p">,</span><span class="ss">"brs01"</span><span class="p">)</span>  <span class="k">order</span> <span class="k">by</span> <span class="n">prod_name</span><span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_b17fb83defde4297aabd3789e4bf03e6-1"></a><span class="k">select</span> <span class="n">prod_name</span><span class="p">,</span> <span class="n">prod_price</span> <span class="k">from</span> <span class="n">Products</span> <span class="k">where</span> <span class="n">vend_id</span> <span class="o">=</span> <span class="ss">"DLL01"</span> <span class="k">or</span>
<a name="rest_code_b17fb83defde4297aabd3789e4bf03e6-2"></a><span class="n">vend_id</span> <span class="o">=</span> <span class="ss">"BRS01"</span> <span class="k">order</span> <span class="k">by</span> <span class="n">prod_name</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="using-the-not-operator">
<h3>Using the NOT Operator</h3>
<pre class="code sql"><a name="rest_code_ba53ceb2b649418684efc296edde1c07-1"></a><span class="k">select</span> <span class="n">prod_name</span><span class="p">,</span> <span class="n">vend_id</span>
<a name="rest_code_ba53ceb2b649418684efc296edde1c07-2"></a><span class="k">from</span> <span class="n">Products</span>
<a name="rest_code_ba53ceb2b649418684efc296edde1c07-3"></a><span class="k">where</span> <span class="k">not</span> <span class="n">vend_id</span> <span class="o">=</span> <span class="ss">"DLL01"</span>
<a name="rest_code_ba53ceb2b649418684efc296edde1c07-4"></a><span class="k">order</span> <span class="k">by</span> <span class="mi">1</span><span class="p">;</span>
</pre>
</div>
</div>
<div class="section" id="using-wildcard-filtering">
<h2>6.Using Wildcard Filtering</h2>
<p>总结 从wildcard出发,推导出来regex的必要性. %, _, brackets 当然最重要的一点是regex, 日后便只用rlike</p>
<div class="section" id="id1">
<span id="using-wildcard-filtering-1"></span><h3>Using Wildcard Filtering</h3>
<div class="section" id="the-percent-sign-wildcard">
<h4>The Percent Sign (%) Wildcard</h4>
<pre class="code sql"><a name="rest_code_18a1f0c78cd6439f931ca25c0570c81b-1"></a><span class="k">select</span> <span class="n">prod_id</span><span class="p">,</span> <span class="n">prod_name</span> <span class="k">from</span> <span class="n">Products</span> <span class="k">where</span> <span class="n">prod_name</span> <span class="k">like</span>  <span class="ss">"fish%"</span><span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_eef5aa35158f4d278afb595fdb45f140-1"></a><span class="k">select</span> <span class="n">prod_id</span><span class="p">,</span> <span class="n">prod_name</span>
<a name="rest_code_eef5aa35158f4d278afb595fdb45f140-2"></a><span class="k">from</span> <span class="n">Products</span>
<a name="rest_code_eef5aa35158f4d278afb595fdb45f140-3"></a><span class="k">where</span> <span class="n">prod_name</span> <span class="k">like</span> <span class="ss">"%bean bag%"</span>
</pre>
<pre class="code sql"><a name="rest_code_912d15dadb104844a4614843e0badd1a-1"></a><span class="k">select</span> <span class="n">prod_name</span> <span class="k">from</span> <span class="n">Products</span> <span class="k">where</span> <span class="n">prod_name</span> <span class="k">like</span> <span class="ss">"f%y"</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="the-underscore-wildcard">
<h4>The Underscore (_) Wildcard</h4>
<pre class="code sql"><a name="rest_code_70e64683f2124203987eb9e4b649d2c0-1"></a><span class="k">select</span> <span class="n">prod_name</span><span class="p">,</span> <span class="n">prod_price</span>
<a name="rest_code_70e64683f2124203987eb9e4b649d2c0-2"></a><span class="k">from</span> <span class="n">Products</span>
<a name="rest_code_70e64683f2124203987eb9e4b649d2c0-3"></a><span class="k">where</span> <span class="n">prod_name</span> <span class="k">like</span> <span class="ss">"__ inch teddy bear"</span><span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_37f391c65fa74811a1090b1e2ffd1fab-1"></a><span class="k">select</span> <span class="n">prod_id</span><span class="p">,</span> <span class="n">prod_name</span> <span class="k">from</span> <span class="n">Products</span>
<a name="rest_code_37f391c65fa74811a1090b1e2ffd1fab-2"></a><span class="k">where</span> <span class="n">prod_name</span> <span class="k">like</span>  <span class="ss">"%inch teddy bear"</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="the-brackets-wildcard">
<h4>The Brackets ([]) Wildcard</h4>
<pre class="code sql"><a name="rest_code_9cfec5b1864e4eafa7b3e5aa8b8adc3a-1"></a><span class="k">select</span> <span class="n">cust_contact</span> <span class="k">from</span> <span class="n">Customers</span> <span class="k">where</span> <span class="n">cust_contact</span> <span class="n">rlike</span>
<a name="rest_code_9cfec5b1864e4eafa7b3e5aa8b8adc3a-2"></a><span class="s1">'[JM].*'</span> <span class="k">order</span> <span class="k">by</span> <span class="n">cust_contact</span><span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_22f9071a5097452e8b6188fef64acfe6-1"></a><span class="k">select</span> <span class="n">cust_contact</span> <span class="k">from</span> <span class="n">Customers</span> <span class="k">where</span> <span class="n">cust_contact</span> <span class="n">rlike</span>
<a name="rest_code_22f9071a5097452e8b6188fef64acfe6-2"></a><span class="ss">"[^JM].*"</span> <span class="k">order</span> <span class="k">by</span> <span class="n">cust_contact</span><span class="p">;</span>
</pre>
</div>
</div>
</div>
<div class="section" id="creating-calculated-fields">
<h2>7.Creating Calculated Fields</h2>
<p>最有意思的一点便是用select测试functions and calcuations calculated field, concat, alias, true calcualtion(expanded price) contat便是对字符串预处理. 从calculated fields引出来</p>
<div class="section" id="concatenating-fields">
<h3>Concatenating Fields</h3>
<pre class="code sql"><a name="rest_code_648d1f23b4d943a1b6e64372993e8670-1"></a><span class="k">select</span> <span class="n">concat</span><span class="p">(</span><span class="n">vend_name</span><span class="p">,</span> <span class="ss">"("</span><span class="p">,</span> <span class="n">vend_country</span><span class="p">,</span> <span class="ss">")"</span><span class="p">)</span>
<a name="rest_code_648d1f23b4d943a1b6e64372993e8670-2"></a><span class="k">from</span> <span class="n">Vendors</span>
<a name="rest_code_648d1f23b4d943a1b6e64372993e8670-3"></a><span class="k">order</span> <span class="k">by</span> <span class="n">vend_name</span><span class="p">;</span>
</pre>
<div class="section" id="using-aliases">
<h4>Using Aliases</h4>
<pre class="code sql"><a name="rest_code_a2fc41b2c9f6404babf4de5227fc63cd-1"></a><span class="k">select</span> <span class="n">concat</span><span class="p">(</span><span class="n">vend_name</span><span class="p">,</span> <span class="ss">" ("</span><span class="p">,</span> <span class="n">vend_country</span><span class="p">,</span> <span class="ss">")"</span><span class="p">)</span> <span class="k">as</span> <span class="n">vend_title</span>
<a name="rest_code_a2fc41b2c9f6404babf4de5227fc63cd-2"></a><span class="k">from</span> <span class="n">Vendors</span>
<a name="rest_code_a2fc41b2c9f6404babf4de5227fc63cd-3"></a><span class="k">order</span> <span class="k">by</span> <span class="n">vend_name</span><span class="p">;</span>
</pre>
</div>
</div>
<div class="section" id="performing-mathematical-calcualtions">
<h3>Performing Mathematical Calcualtions</h3>
<pre class="code sql"><a name="rest_code_cb6b7be0ad8548a1846d9e7f6ed70f92-1"></a><span class="k">select</span> <span class="n">prod_id</span><span class="p">,</span><span class="n">quantity</span><span class="p">,</span> <span class="n">item_price</span><span class="p">,</span>
<a name="rest_code_cb6b7be0ad8548a1846d9e7f6ed70f92-2"></a><span class="n">quantity</span><span class="o">*</span><span class="n">item_price</span> <span class="k">as</span> <span class="n">expanded_price</span>
<a name="rest_code_cb6b7be0ad8548a1846d9e7f6ed70f92-3"></a><span class="k">from</span> <span class="n">OrderItems</span>
<a name="rest_code_cb6b7be0ad8548a1846d9e7f6ed70f92-4"></a><span class="k">where</span> <span class="n">order_num</span> <span class="o">=</span> <span class="mi">20008</span><span class="p">;</span>
</pre>
<p><strong>Table 7.1. SQL Mathematical Operators</strong></p>
<p><a class="reference external" href="http://heropublic.oss-cn-beijing.aliyuncs.com/024821">http://heropublic.oss-cn-beijing.aliyuncs.com/024821</a></p>
</div>
</div>
<div class="section" id="using-data-manipulation-functions">
<h2>8.Using Data Manipulation Functions</h2>
<p>总结 functions中的4点:</p>
<ol class="arabic simple">
<li><p>text (soundex) ;;最有意思的一点.</p></li>
<li><p>numeric</p></li>
<li><p>date and time</p></li>
<li><p>system infos</p></li>
</ol>
<div class="section" id="understanding-functions">
<h3>Understanding Functions</h3>
<div class="section" id="the-problem-with-functions">
<h4>The Problem with Functions</h4>
<div class="figure">
<img alt="Screen Shot 2018-08-12 at 10.59.11 AM" src="http://heropublic.oss-cn-beijing.aliyuncs.com/025926.png"><p class="caption">Screen Shot 2018-08-12 at 10.59.11 AM</p>
</div>
</div>
</div>
<div class="section" id="using-functions">
<h3>Using Functions</h3>
<div class="section" id="text-manipulation-functions">
<h4>Text Manipulation Functions</h4>
<pre class="code sql"><a name="rest_code_a9c04dfedeff465485f69810ccf84ddb-1"></a><span class="k">select</span> <span class="n">vend_name</span><span class="p">,</span> <span class="k">upper</span><span class="p">(</span><span class="n">vend_name</span><span class="p">)</span> <span class="k">as</span> <span class="n">vend_name_upcase</span>
<a name="rest_code_a9c04dfedeff465485f69810ccf84ddb-2"></a><span class="k">from</span> <span class="n">Vendors</span>
<a name="rest_code_a9c04dfedeff465485f69810ccf84ddb-3"></a><span class="k">order</span> <span class="k">by</span> <span class="n">vend_name</span><span class="p">;</span>
</pre>
<p><strong>Table 8.2. Commonly Used Text-Manipulation Functions</strong></p>
<div class="figure">
<img alt="Screen Shot 2018-08-12 at 11.45.20 AM" src="http://heropublic.oss-cn-beijing.aliyuncs.com/034543.png"><p class="caption">Screen Shot 2018-08-12 at 11.45.20 AM</p>
</div>
<pre class="code sql"><a name="rest_code_01d55181149e40388031bc4f51fe8824-1"></a><span class="k">select</span> <span class="n">cust_name</span><span class="p">,</span> <span class="n">cust_contact</span> <span class="k">from</span> <span class="n">Customers</span> <span class="k">where</span> <span class="n">cust_contact</span> <span class="o">=</span> <span class="ss">"Michael Green"</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="date-and-time-manipulation-functions">
<h4>Date and Time Manipulation Functions</h4>
<pre class="code sql"><a name="rest_code_8d30808f129042af8ea94a66aa578e6e-1"></a><span class="k">select</span> <span class="o">*</span>
<a name="rest_code_8d30808f129042af8ea94a66aa578e6e-2"></a><span class="k">from</span> <span class="n">Orders</span>
<a name="rest_code_8d30808f129042af8ea94a66aa578e6e-3"></a><span class="k">where</span> <span class="k">year</span><span class="p">(</span><span class="n">order_date</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2012</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="numeric-manipulation-functions">
<h4>Numeric Manipulation Functions</h4>
<div class="figure">
<img alt="Screen Shot 2018-08-12 at 11.33.29 AM" src="http://heropublic.oss-cn-beijing.aliyuncs.com/033344.png"><p class="caption">Screen Shot 2018-08-12 at 11.33.29 AM</p>
</div>
</div>
</div>
</div>
<div class="section" id="summarizing-data">
<h2>9.Summarizing Data</h2>
<p>总结:</p>
<p>avg, min, max, sum, count, # 首先讲avg放在前面</p>
<p>与distinct相结合.</p>
<div class="section" id="using-aggregate-functions">
<h3>Using Aggregate Functions</h3>
<p><strong>Table 9.1. SQL Aggregate Functions</strong></p>
<div class="figure">
<img alt="Screen Shot 2018-08-12 at 12.00.30 PM" src="http://heropublic.oss-cn-beijing.aliyuncs.com/040046.png"><p class="caption">Screen Shot 2018-08-12 at 12.00.30 PM</p>
</div>
<div class="section" id="the-avg-function">
<h4>The AVG() Function</h4>
<pre class="code sql"><a name="rest_code_2bdb9ed9a4884530bcfcec63fecf8ec4-1"></a><span class="k">select</span> <span class="k">avg</span><span class="p">(</span><span class="n">prod_price</span><span class="p">)</span> <span class="k">as</span> <span class="n">avg_price</span> <span class="k">from</span> <span class="n">Products</span><span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_8dcd8b625c5f4ca98d779ec64b9ab434-1"></a><span class="k">sql</span> <span class="p">:</span><span class="n">engine</span> <span class="n">mysql</span> <span class="p">:</span><span class="n">dbuser</span> <span class="n">org</span> <span class="p">:</span><span class="k">database</span> <span class="n">grocer</span>
<a name="rest_code_8dcd8b625c5f4ca98d779ec64b9ab434-2"></a><span class="k">select</span> <span class="n">vend_id</span><span class="p">,</span> <span class="k">avg</span><span class="p">(</span><span class="n">prod_price</span><span class="p">)</span> <span class="k">as</span> <span class="n">avg_price</span>
<a name="rest_code_8dcd8b625c5f4ca98d779ec64b9ab434-3"></a><span class="k">from</span> <span class="n">Products</span>
<a name="rest_code_8dcd8b625c5f4ca98d779ec64b9ab434-4"></a><span class="k">where</span> <span class="n">vend_id</span> <span class="o">=</span> <span class="ss">"DLL01"</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="the-count-function">
<h4>The COUNT() Function</h4>
<pre class="code sql"><a name="rest_code_60fce8872950455382f3f8ef6b56a118-1"></a><span class="k">select</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">as</span> <span class="n">num_cust</span>
<a name="rest_code_60fce8872950455382f3f8ef6b56a118-2"></a><span class="k">from</span> <span class="n">Customers</span><span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_cb59f1917315499497a9b54bfb018891-1"></a><span class="k">select</span> <span class="k">count</span><span class="p">(</span><span class="n">cust_email</span><span class="p">)</span> <span class="k">as</span> <span class="n">num_cust</span>
<a name="rest_code_cb59f1917315499497a9b54bfb018891-2"></a><span class="k">from</span> <span class="n">Customers</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="the-max-function">
<h4>The MAX() Function</h4>
<pre class="code sql"><a name="rest_code_daaf7cdb1bae4501ae849398743a1eca-1"></a><span class="k">select</span> <span class="k">max</span><span class="p">(</span><span class="n">prod_price</span><span class="p">)</span> <span class="k">as</span> <span class="n">max_price</span>
<a name="rest_code_daaf7cdb1bae4501ae849398743a1eca-2"></a><span class="k">from</span> <span class="n">Products</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="the-min-function">
<h4>The MIN() Function</h4>
<pre class="code sql"><a name="rest_code_b1f01e14dd864c448c1573540734f1a4-1"></a><span class="k">select</span> <span class="k">min</span><span class="p">(</span><span class="n">prod_price</span><span class="p">)</span> <span class="k">as</span> <span class="n">min_price</span>
<a name="rest_code_b1f01e14dd864c448c1573540734f1a4-2"></a><span class="k">from</span> <span class="n">Products</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="the-sum">
<h4>The SUM()</h4>
<pre class="code sql"><a name="rest_code_edba028e906b43a4ae6a2e08345480ff-1"></a><span class="k">select</span> <span class="k">sum</span><span class="p">(</span><span class="n">quantity</span><span class="p">)</span> <span class="k">as</span> <span class="n">items_ordered</span>
<a name="rest_code_edba028e906b43a4ae6a2e08345480ff-2"></a><span class="k">from</span> <span class="n">OrderItems</span>
<a name="rest_code_edba028e906b43a4ae6a2e08345480ff-3"></a><span class="k">where</span> <span class="n">order_num</span> <span class="o">=</span> <span class="mi">20005</span><span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_c69796e1db0645c3b428e177762eaab7-1"></a><span class="k">select</span> <span class="k">sum</span><span class="p">(</span><span class="n">item_price</span><span class="o">*</span><span class="n">quantity</span><span class="p">)</span> <span class="k">as</span> <span class="n">total_price</span>
<a name="rest_code_c69796e1db0645c3b428e177762eaab7-2"></a><span class="k">from</span> <span class="n">OrderItems</span>
<a name="rest_code_c69796e1db0645c3b428e177762eaab7-3"></a><span class="k">where</span> <span class="n">order_num</span> <span class="o">=</span> <span class="mi">20005</span><span class="p">;</span>
</pre>
</div>
</div>
<div class="section" id="aggregates-on-distinct-values">
<h3>Aggregates on Distinct Values</h3>
<pre class="code sql"><a name="rest_code_e31b2742594b4425ab764c88161d815d-1"></a><span class="k">select</span> <span class="k">avg</span><span class="p">(</span><span class="k">distinct</span> <span class="n">prod_price</span><span class="p">)</span> <span class="k">as</span> <span class="n">avg_price</span>
<a name="rest_code_e31b2742594b4425ab764c88161d815d-2"></a><span class="k">from</span> <span class="n">Products</span>
<a name="rest_code_e31b2742594b4425ab764c88161d815d-3"></a><span class="k">where</span> <span class="n">vend_id</span> <span class="o">=</span> <span class="ss">"DLL01"</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="combining-aggregate-functions">
<h3>Combining Aggregate Functions</h3>
<pre class="code sql"><a name="rest_code_16fabd64080948b48733dd43bd2d56f5-1"></a><span class="k">select</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">as</span> <span class="n">num_items</span><span class="p">,</span>
<a name="rest_code_16fabd64080948b48733dd43bd2d56f5-2"></a><span class="k">min</span><span class="p">(</span><span class="n">prod_price</span><span class="p">)</span> <span class="k">as</span> <span class="n">min_price</span><span class="p">,</span>
<a name="rest_code_16fabd64080948b48733dd43bd2d56f5-3"></a><span class="k">max</span><span class="p">(</span><span class="n">prod_price</span><span class="p">)</span> <span class="k">as</span> <span class="n">max_price</span><span class="p">,</span>
<a name="rest_code_16fabd64080948b48733dd43bd2d56f5-4"></a><span class="k">avg</span><span class="p">(</span><span class="n">prod_price</span><span class="p">)</span> <span class="k">as</span> <span class="n">avg_price</span>
<a name="rest_code_16fabd64080948b48733dd43bd2d56f5-5"></a><span class="k">from</span> <span class="n">Products</span><span class="p">;</span>
</pre>
</div>
</div>
<div class="section" id="grouping-data">
<h2>10.Grouping Data</h2>
<p>总结, group by之后, 可以应用aggregate calculation 针对单一的column, filter, group and sort 棒, 总结当下所学. select, from, where, group by, having, order by</p>
<div class="section" id="creating-groups">
<h3>Creating Groups</h3>
<pre class="code sql"><a name="rest_code_f38c79ba8caf4b549108b8de1eaa4395-1"></a><span class="k">select</span> <span class="n">vend_id</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">as</span> <span class="n">num_prods</span>
<a name="rest_code_f38c79ba8caf4b549108b8de1eaa4395-2"></a><span class="k">from</span> <span class="n">Products</span>
<a name="rest_code_f38c79ba8caf4b549108b8de1eaa4395-3"></a><span class="k">group</span> <span class="k">by</span> <span class="n">vend_id</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="filtering-groups">
<h3>Filtering Groups</h3>
<pre class="code sql"><a name="rest_code_1b1eec21b32d47e892febff83f170e3d-1"></a><span class="k">select</span> <span class="n">cust_id</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">as</span> <span class="n">orders</span>
<a name="rest_code_1b1eec21b32d47e892febff83f170e3d-2"></a><span class="k">from</span> <span class="n">Orders</span>
<a name="rest_code_1b1eec21b32d47e892febff83f170e3d-3"></a><span class="k">group</span> <span class="k">by</span> <span class="n">cust_id</span>
<a name="rest_code_1b1eec21b32d47e892febff83f170e3d-4"></a><span class="k">having</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">&gt;=</span><span class="mi">2</span> <span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_d5d2f3309a474fa9a03ad714b69f5270-1"></a><span class="k">select</span> <span class="n">vend_id</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="n">vend_id</span><span class="p">)</span> <span class="k">as</span> <span class="n">num_prods</span>
<a name="rest_code_d5d2f3309a474fa9a03ad714b69f5270-2"></a><span class="k">from</span> <span class="n">Products</span>
<a name="rest_code_d5d2f3309a474fa9a03ad714b69f5270-3"></a><span class="k">where</span> <span class="n">prod_price</span> <span class="o">&gt;=</span> <span class="mi">4</span>
<a name="rest_code_d5d2f3309a474fa9a03ad714b69f5270-4"></a><span class="k">group</span> <span class="k">by</span> <span class="n">vend_id</span>
<a name="rest_code_d5d2f3309a474fa9a03ad714b69f5270-5"></a><span class="k">having</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_bc0a9199ae544912adbba261afeb3e54-1"></a><span class="k">select</span> <span class="n">vend_id</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">as</span> <span class="n">num_prods</span> <span class="k">from</span> <span class="n">Products</span> <span class="k">group</span> <span class="k">by</span> <span class="n">vend_id</span> <span class="k">having</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">&gt;=</span><span class="mi">2</span> <span class="p">;</span>
</pre>
</div>
<div class="section" id="grouping-and-sorting">
<h3>Grouping and Sorting</h3>
<div class="figure">
<img alt="Screen Shot 2018-08-12 at 3.07.00 PM" src="http://heropublic.oss-cn-beijing.aliyuncs.com/070716.png"><p class="caption">Screen Shot 2018-08-12 at 3.07.00 PM</p>
</div>
<pre class="code sql"><a name="rest_code_490a7aa0267940dca500e0128dd8c297-1"></a><span class="k">select</span> <span class="n">order_num</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">as</span> <span class="n">items</span>
<a name="rest_code_490a7aa0267940dca500e0128dd8c297-2"></a><span class="k">from</span> <span class="n">OrderItems</span>
<a name="rest_code_490a7aa0267940dca500e0128dd8c297-3"></a><span class="k">group</span> <span class="k">by</span> <span class="n">order_num</span>
<a name="rest_code_490a7aa0267940dca500e0128dd8c297-4"></a><span class="k">having</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span>
<a name="rest_code_490a7aa0267940dca500e0128dd8c297-5"></a><span class="k">order</span> <span class="k">by</span> <span class="n">order_num</span> <span class="k">desc</span><span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_ee363c93223f48d9b293e8ccca54df4a-1"></a><span class="k">select</span> <span class="n">order_num</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">as</span> <span class="n">items</span> <span class="k">from</span> <span class="n">OrderItems</span> <span class="k">group</span> <span class="k">by</span> <span class="n">order_num</span> <span class="k">having</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span> <span class="k">order</span> <span class="k">by</span> <span class="n">items</span><span class="p">,</span> <span class="n">order_num</span><span class="p">;</span>
</pre>
</div>
</div>
<div class="section" id="working-with-subqueries">
<h2>11.Working with Subqueries</h2>
<p>总结归纳 subqueries, filter by subqueries(用in), calculated fields</p>
<div class="section" id="filtering-by-subquery">
<h3>Filtering by Subquery</h3>
<pre class="code sql"><a name="rest_code_6940680529114c5a831437c1016110ec-1"></a><span class="k">select</span> <span class="n">cust_id</span> <span class="k">from</span> <span class="n">Orders</span>
<a name="rest_code_6940680529114c5a831437c1016110ec-2"></a><span class="k">where</span> <span class="n">order_num</span> <span class="k">in</span> <span class="p">(</span><span class="k">select</span> <span class="n">order_num</span> <span class="k">from</span> <span class="n">OrderItems</span> <span class="k">where</span> <span class="n">prod_id</span> <span class="o">=</span> <span class="ss">"rgan01"</span><span class="p">);</span>
</pre>
<pre class="code sql"><a name="rest_code_3318237f2e7249d29a3eb5a4d4d85574-1"></a><span class="k">SELECT</span> <span class="n">cust_id</span> <span class="k">from</span> <span class="n">Orders</span> <span class="k">WHERE</span> <span class="n">order_num</span> <span class="k">IN</span> <span class="p">(</span><span class="mi">20007</span><span class="p">,</span><span class="mi">20008</span><span class="p">)</span>
</pre>
<pre class="code sql"><a name="rest_code_f2e5ccab750d48c8aa660473d82272c6-1"></a><span class="k">select</span> <span class="n">cust_name</span><span class="p">,</span> <span class="n">cust_contact</span>
<a name="rest_code_f2e5ccab750d48c8aa660473d82272c6-2"></a><span class="k">from</span> <span class="n">Customers</span>
<a name="rest_code_f2e5ccab750d48c8aa660473d82272c6-3"></a><span class="k">where</span> <span class="n">cust_id</span> <span class="k">in</span> <span class="p">(</span><span class="ss">"1000000004"</span><span class="p">,</span> <span class="ss">"1000000005"</span><span class="p">);</span>
</pre>
<pre class="code sql"><a name="rest_code_cfbddc3a61f84a6792ed9ea9e1638699-1"></a><span class="k">select</span> <span class="n">cust_name</span><span class="p">,</span> <span class="n">cust_contact</span> <span class="k">from</span> <span class="n">Customers</span>
<a name="rest_code_cfbddc3a61f84a6792ed9ea9e1638699-2"></a><span class="k">where</span> <span class="n">cust_id</span> <span class="k">in</span> <span class="p">(</span><span class="k">select</span> <span class="n">cust_id</span> <span class="k">from</span> <span class="n">Orders</span> <span class="k">where</span> <span class="n">order_num</span> <span class="k">in</span>
<a name="rest_code_cfbddc3a61f84a6792ed9ea9e1638699-3"></a><span class="p">(</span><span class="k">select</span> <span class="n">order_num</span> <span class="k">from</span> <span class="n">OrderItems</span> <span class="k">where</span> <span class="n">prod_id</span> <span class="o">=</span> <span class="ss">"rgan01"</span><span class="p">));</span>
</pre>
</div>
<div class="section" id="using-subqueries-as-calculated-fields">
<h3>Using Subqueries as Calculated Fields</h3>
<pre class="code sql"><a name="rest_code_f307679027ac45909299b6f2c74b2170-1"></a><span class="k">select</span> <span class="n">cust_id</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">as</span> <span class="n">orders</span> <span class="k">from</span> <span class="n">Orders</span> <span class="k">group</span> <span class="k">by</span> <span class="n">cust_id</span><span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_4c2dd5dd81ae47deab4dc1b65015eac5-1"></a><span class="k">select</span> <span class="n">cust_name</span><span class="p">,</span> <span class="n">cust_state</span><span class="p">,</span>
<a name="rest_code_4c2dd5dd81ae47deab4dc1b65015eac5-2"></a><span class="p">(</span><span class="k">select</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">from</span> <span class="n">Orders</span> <span class="k">where</span> <span class="n">Orders</span><span class="p">.</span><span class="n">cust_id</span> <span class="o">=</span> <span class="n">Customers</span><span class="p">.</span><span class="n">cust_id</span><span class="p">)</span> <span class="k">as</span> <span class="n">orders</span>
<a name="rest_code_4c2dd5dd81ae47deab4dc1b65015eac5-3"></a><span class="k">from</span> <span class="n">Customers</span>
<a name="rest_code_4c2dd5dd81ae47deab4dc1b65015eac5-4"></a><span class="k">order</span> <span class="k">by</span> <span class="n">cust_name</span><span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_6088ec6c76aa45a59fb0115fdfe902c0-1"></a><span class="k">select</span> <span class="n">cust_id</span><span class="p">,</span> <span class="n">cust_state</span><span class="p">,</span>
<a name="rest_code_6088ec6c76aa45a59fb0115fdfe902c0-2"></a><span class="p">(</span><span class="k">select</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">from</span> <span class="n">Orders</span> <span class="k">where</span> <span class="n">Orders</span><span class="p">.</span><span class="n">cust_id</span> <span class="o">=</span> <span class="n">Customers</span><span class="p">.</span><span class="n">cust_id</span><span class="p">)</span> <span class="k">as</span> <span class="n">orders</span>
<a name="rest_code_6088ec6c76aa45a59fb0115fdfe902c0-3"></a><span class="k">from</span> <span class="n">Customers</span>
<a name="rest_code_6088ec6c76aa45a59fb0115fdfe902c0-4"></a><span class="k">order</span> <span class="k">by</span> <span class="n">cust_name</span><span class="p">;</span>
</pre>
</div>
</div>
<div class="section" id="joining-tables">
<h2>12.Joining Tables</h2>
<p>解决subquery的问题而引入join 先join再查询, break down然后再join回去. inner join, where, multiple tables</p>
<div class="section" id="creating-a-join">
<h3>Creating a Join</h3>
<pre class="code sql"><a name="rest_code_6b549767d93b4da58f67986fb98b464f-1"></a><span class="k">select</span> <span class="n">vend_name</span><span class="p">,</span> <span class="n">prod_name</span><span class="p">,</span> <span class="n">prod_price</span>
<a name="rest_code_6b549767d93b4da58f67986fb98b464f-2"></a><span class="k">from</span> <span class="n">Vendors</span><span class="p">,</span> <span class="n">Products</span>
<a name="rest_code_6b549767d93b4da58f67986fb98b464f-3"></a><span class="k">where</span> <span class="n">Vendors</span><span class="p">.</span><span class="n">vend_id</span> <span class="o">=</span> <span class="n">Products</span><span class="p">.</span><span class="n">vend_id</span><span class="p">;</span>
</pre>
<div class="section" id="the-importance-of-the-where-clause">
<h4>The Importance of the WHERE Clause</h4>
<pre class="code sql"><a name="rest_code_b91ddefa9199432caaa46b55aca99d14-1"></a><span class="k">select</span> <span class="n">vend_name</span><span class="p">,</span> <span class="n">prod_name</span><span class="p">,</span> <span class="n">prod_price</span>
<a name="rest_code_b91ddefa9199432caaa46b55aca99d14-2"></a><span class="k">from</span> <span class="n">Vendors</span><span class="p">,</span> <span class="n">Products</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="inner-joins">
<h4>Inner Joins</h4>
<pre class="code sql"><a name="rest_code_89072f8006a64f36aef15f9cb1457f3c-1"></a><span class="k">select</span> <span class="n">vend_name</span><span class="p">,</span> <span class="n">prod_name</span><span class="p">,</span> <span class="n">prod_price</span>
<a name="rest_code_89072f8006a64f36aef15f9cb1457f3c-2"></a><span class="k">from</span> <span class="n">Vendors</span> <span class="k">inner</span> <span class="k">join</span> <span class="n">Products</span>
<a name="rest_code_89072f8006a64f36aef15f9cb1457f3c-3"></a><span class="k">on</span> <span class="n">Vendors</span><span class="p">.</span><span class="n">vend_id</span> <span class="o">=</span> <span class="n">Products</span><span class="p">.</span><span class="n">vend_id</span><span class="p">;</span>
<a name="rest_code_89072f8006a64f36aef15f9cb1457f3c-4"></a><span class="o">#</span> <span class="n">comfortable</span> <span class="k">with</span> <span class="n">this</span> <span class="n">solution</span>
</pre>
</div>
<div class="section" id="joining-multiple-tables">
<h4>Joining Multiple Tables</h4>
<pre class="code sql"><a name="rest_code_c2509a28777f4a7b9dc9b640d071ebb0-1"></a><span class="k">select</span> <span class="n">prod_name</span><span class="p">,</span> <span class="n">vend_name</span><span class="p">,</span> <span class="n">prod_price</span><span class="p">,</span> <span class="n">quantity</span>
<a name="rest_code_c2509a28777f4a7b9dc9b640d071ebb0-2"></a><span class="k">from</span> <span class="n">OrderItems</span><span class="p">,</span> <span class="n">Products</span><span class="p">,</span> <span class="n">Vendors</span>
<a name="rest_code_c2509a28777f4a7b9dc9b640d071ebb0-3"></a><span class="k">where</span> <span class="n">Products</span><span class="p">.</span><span class="n">vend_id</span> <span class="o">=</span> <span class="n">Vendors</span><span class="p">.</span><span class="n">vend_id</span>
<a name="rest_code_c2509a28777f4a7b9dc9b640d071ebb0-4"></a><span class="k">and</span> <span class="n">OrderItems</span><span class="p">.</span><span class="n">prod_id</span> <span class="o">=</span> <span class="n">Products</span><span class="p">.</span><span class="n">prod_id</span>
<a name="rest_code_c2509a28777f4a7b9dc9b640d071ebb0-5"></a><span class="k">and</span> <span class="n">order_num</span> <span class="o">=</span> <span class="mi">20007</span><span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_fbe51b1d526740c19aa24d0f343ce750-1"></a><span class="k">SELECT</span> <span class="n">cust_name</span><span class="p">,</span> <span class="n">cust_contact</span>
<a name="rest_code_fbe51b1d526740c19aa24d0f343ce750-2"></a><span class="k">FROM</span> <span class="n">Customers</span>
<a name="rest_code_fbe51b1d526740c19aa24d0f343ce750-3"></a><span class="k">WHERE</span> <span class="n">cust_id</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">cust_id</span>
<a name="rest_code_fbe51b1d526740c19aa24d0f343ce750-4"></a>                  <span class="k">FROM</span> <span class="n">Orders</span>
<a name="rest_code_fbe51b1d526740c19aa24d0f343ce750-5"></a>                  <span class="k">WHERE</span> <span class="n">order_num</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">order_num</span>
<a name="rest_code_fbe51b1d526740c19aa24d0f343ce750-6"></a>                                      <span class="k">FROM</span> <span class="n">OrderItems</span>
<a name="rest_code_fbe51b1d526740c19aa24d0f343ce750-7"></a>                                      <span class="k">WHERE</span> <span class="n">prod_id</span> <span class="o">=</span> <span class="s1">'RGAN01'</span><span class="p">));</span>
<a name="rest_code_fbe51b1d526740c19aa24d0f343ce750-8"></a><span class="o">#</span><span class="err">这用于思考的过程</span>
</pre>
<pre class="code sql"><a name="rest_code_ad9eb8d2945646319e6d59d254fe9fbc-1"></a><span class="k">select</span> <span class="n">cust_name</span><span class="p">,</span> <span class="n">cust_contact</span>
<a name="rest_code_ad9eb8d2945646319e6d59d254fe9fbc-2"></a><span class="k">from</span> <span class="n">Customers</span><span class="p">,</span> <span class="n">Orders</span><span class="p">,</span> <span class="n">OrderItems</span>
<a name="rest_code_ad9eb8d2945646319e6d59d254fe9fbc-3"></a><span class="k">where</span> <span class="n">customers</span><span class="p">.</span><span class="n">cust_id</span> <span class="o">=</span> <span class="n">orders</span><span class="p">.</span><span class="n">cust_id</span>
<a name="rest_code_ad9eb8d2945646319e6d59d254fe9fbc-4"></a><span class="k">and</span> <span class="n">orders</span><span class="p">.</span><span class="n">order_num</span> <span class="o">=</span> <span class="n">orderitems</span><span class="p">.</span><span class="n">order_num</span>
<a name="rest_code_ad9eb8d2945646319e6d59d254fe9fbc-5"></a><span class="k">and</span> <span class="n">prod_id</span> <span class="o">=</span> <span class="s1">'rgan01'</span><span class="p">;</span>
</pre>
</div>
</div>
</div>
<div class="section" id="creating-advanced-joins">
<h2>13.Creating Advanced Joins</h2>
<p>总结 table alias outer join, join便是对接的部分. (inner join忽略null) 在join中使用aggregate</p>
<div class="section" id="using-table-aliases">
<h3>Using Table Aliases</h3>
<pre class="code sql"><a name="rest_code_dec5a37a0d5446798fa9367530cd0a75-1"></a><span class="k">select</span> <span class="n">concat</span><span class="p">(</span><span class="n">vend_name</span><span class="p">,</span> <span class="ss">" ("</span><span class="p">,</span> <span class="n">vend_country</span><span class="p">,</span> <span class="ss">") "</span><span class="p">)</span>
<a name="rest_code_dec5a37a0d5446798fa9367530cd0a75-2"></a><span class="k">as</span> <span class="n">vend_title</span>
<a name="rest_code_dec5a37a0d5446798fa9367530cd0a75-3"></a><span class="k">from</span> <span class="n">Vendors</span>
<a name="rest_code_dec5a37a0d5446798fa9367530cd0a75-4"></a><span class="k">order</span> <span class="k">by</span> <span class="n">vend_name</span><span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_fdccb130b6114aa4b23c49ef8794b730-1"></a><span class="k">select</span> <span class="n">cust_name</span><span class="p">,</span> <span class="n">cust_contact</span>
<a name="rest_code_fdccb130b6114aa4b23c49ef8794b730-2"></a><span class="k">from</span> <span class="n">Customers</span> <span class="k">as</span> <span class="k">c</span><span class="p">,</span> <span class="n">Orders</span> <span class="k">as</span> <span class="n">o</span><span class="p">,</span> <span class="n">OrderItems</span> <span class="k">as</span> <span class="n">oi</span>
<a name="rest_code_fdccb130b6114aa4b23c49ef8794b730-3"></a><span class="k">where</span> <span class="k">c</span><span class="p">.</span><span class="n">cust_id</span><span class="o">=</span><span class="n">o</span><span class="p">.</span><span class="n">cust_id</span>
<a name="rest_code_fdccb130b6114aa4b23c49ef8794b730-4"></a><span class="k">and</span> <span class="n">oi</span><span class="p">.</span><span class="n">order_num</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="n">order_num</span>
<a name="rest_code_fdccb130b6114aa4b23c49ef8794b730-5"></a><span class="k">and</span> <span class="n">prod_id</span> <span class="o">=</span> <span class="ss">"rgan01"</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="using-different-join-types">
<h3>Using Different Join Types</h3>
<div class="section" id="self-joins">
<h4>Self Joins</h4>
<pre class="code sql"><a name="rest_code_3a02fd5d170d4c9187c9180ec68a9375-1"></a><span class="k">select</span> <span class="n">cust_id</span><span class="p">,</span> <span class="n">cust_name</span><span class="p">,</span> <span class="n">cust_contact</span>
<a name="rest_code_3a02fd5d170d4c9187c9180ec68a9375-2"></a><span class="k">from</span> <span class="n">Customers</span>
<a name="rest_code_3a02fd5d170d4c9187c9180ec68a9375-3"></a><span class="k">where</span> <span class="n">cust_name</span> <span class="o">=</span> <span class="p">(</span><span class="k">select</span> <span class="n">cust_name</span> <span class="k">from</span> <span class="n">Customers</span> <span class="k">where</span> <span class="n">cust_contact</span><span class="o">=</span><span class="ss">"Jim Jones"</span><span class="p">);</span>
<a name="rest_code_3a02fd5d170d4c9187c9180ec68a9375-4"></a><span class="o">#</span> <span class="err">不喜欢</span><span class="k">self</span> <span class="k">join</span>
</pre>
<pre class="code sql"><a name="rest_code_ee911018b8e845d99c886516d8e30e1d-1"></a><span class="k">select</span> <span class="n">c1</span><span class="p">.</span><span class="n">cust_id</span><span class="p">,</span> <span class="n">c1</span><span class="p">.</span><span class="n">cust_name</span><span class="p">,</span> <span class="n">c1</span><span class="p">.</span><span class="n">cust_contact</span>
<a name="rest_code_ee911018b8e845d99c886516d8e30e1d-2"></a><span class="k">from</span> <span class="n">Customers</span> <span class="k">as</span> <span class="n">c1</span><span class="p">,</span> <span class="n">Customers</span> <span class="k">as</span> <span class="n">c2</span>
<a name="rest_code_ee911018b8e845d99c886516d8e30e1d-3"></a><span class="k">where</span> <span class="n">c1</span><span class="p">.</span><span class="n">cust_name</span> <span class="o">=</span> <span class="n">c2</span><span class="p">.</span><span class="n">cust_name</span>
<a name="rest_code_ee911018b8e845d99c886516d8e30e1d-4"></a><span class="k">and</span> <span class="n">c2</span><span class="p">.</span><span class="n">cust_contact</span> <span class="o">=</span> <span class="ss">"Jim Jones"</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="natural-joins">
<h4>Natural Joins</h4>
<p><img alt="image0" src="http://heropublic.oss-cn-beijing.aliyuncs.com/143411.png"></p>
</div>
<div class="section" id="outer-joins">
<h4>Outer Joins</h4>
<pre class="code sql"><a name="rest_code_b38fca948ba14b2faabf28f0f23eb27c-1"></a><span class="k">select</span> <span class="n">Customers</span><span class="p">.</span><span class="n">cust_id</span><span class="p">,</span> <span class="n">Orders</span><span class="p">.</span><span class="n">order_num</span>
<a name="rest_code_b38fca948ba14b2faabf28f0f23eb27c-2"></a><span class="k">from</span> <span class="n">Customers</span> <span class="k">inner</span> <span class="k">join</span> <span class="n">Orders</span>
<a name="rest_code_b38fca948ba14b2faabf28f0f23eb27c-3"></a><span class="k">on</span> <span class="n">Customers</span><span class="p">.</span><span class="n">cust_id</span> <span class="o">=</span> <span class="n">Orders</span><span class="p">.</span><span class="n">cust_id</span><span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_bbe3683ca5554c6da91385d6fbc06d5d-1"></a><span class="k">select</span> <span class="n">Customers</span><span class="p">.</span><span class="n">cust_id</span><span class="p">,</span> <span class="n">Orders</span><span class="p">.</span><span class="n">order_num</span>
<a name="rest_code_bbe3683ca5554c6da91385d6fbc06d5d-2"></a><span class="k">from</span> <span class="n">Customers</span> <span class="k">left</span> <span class="k">outer</span> <span class="k">join</span> <span class="n">Orders</span>
<a name="rest_code_bbe3683ca5554c6da91385d6fbc06d5d-3"></a><span class="k">on</span> <span class="n">Customers</span><span class="p">.</span><span class="n">cust_id</span> <span class="o">=</span> <span class="n">Orders</span><span class="p">.</span><span class="n">cust_id</span><span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_5e915c99809d428a9fcbfcb25fee3644-1"></a><span class="k">select</span> <span class="n">Customers</span><span class="p">.</span><span class="n">cust_id</span><span class="p">,</span> <span class="n">Orders</span><span class="p">.</span><span class="n">order_num</span>
<a name="rest_code_5e915c99809d428a9fcbfcb25fee3644-2"></a><span class="k">from</span> <span class="n">Customers</span> <span class="k">right</span> <span class="k">outer</span> <span class="k">join</span> <span class="n">Orders</span>
<a name="rest_code_5e915c99809d428a9fcbfcb25fee3644-3"></a><span class="k">on</span> <span class="n">Orders</span><span class="p">.</span><span class="n">cust_id</span> <span class="o">=</span> <span class="n">Customers</span><span class="p">.</span><span class="n">cust_id</span><span class="p">;</span>
</pre>
</div>
</div>
<div class="section" id="using-joins-with-aggregate-functions">
<h3>Using Joins with Aggregate Functions</h3>
<pre class="code sql"><a name="rest_code_6ce190fd0cd24e7aaa775628ce5d6571-1"></a><span class="k">select</span> <span class="n">Customers</span><span class="p">.</span><span class="n">cust_id</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="n">Orders</span><span class="p">.</span><span class="n">order_num</span><span class="p">)</span> <span class="k">as</span> <span class="n">num_order</span>
<a name="rest_code_6ce190fd0cd24e7aaa775628ce5d6571-2"></a><span class="k">from</span> <span class="n">Customers</span><span class="p">,</span> <span class="n">Orders</span>
<a name="rest_code_6ce190fd0cd24e7aaa775628ce5d6571-3"></a><span class="k">where</span> <span class="n">Customers</span><span class="p">.</span><span class="n">cust_id</span> <span class="o">=</span> <span class="n">Orders</span><span class="p">.</span><span class="n">cust_id</span>
<a name="rest_code_6ce190fd0cd24e7aaa775628ce5d6571-4"></a><span class="k">group</span> <span class="k">by</span> <span class="n">Customers</span><span class="p">.</span><span class="n">cust_id</span><span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_8a9830a28b1f464aa425de0eaa027b9a-1"></a><span class="k">select</span> <span class="n">Customers</span><span class="p">.</span><span class="n">cust_id</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="n">Orders</span><span class="p">.</span><span class="n">order_num</span><span class="p">)</span> <span class="k">as</span> <span class="n">num_order</span> <span class="k">from</span> <span class="n">Customers</span><span class="p">,</span> <span class="n">Orders</span> <span class="k">where</span> <span class="n">Customers</span><span class="p">.</span><span class="n">cust_id</span> <span class="o">=</span> <span class="n">Orders</span><span class="p">.</span><span class="n">cust_id</span> <span class="k">group</span> <span class="k">by</span> <span class="n">Customers</span><span class="p">.</span><span class="n">cust_id</span><span class="p">;</span>
</pre>
</div>
</div>
<div class="section" id="combining-queries">
<h2>14.Combining Queries</h2>
<p>总结, 这一章没有实质的内容, union便是or, intersection便是and</p>
<div class="section" id="creating-combined-queries">
<h3>Creating Combined Queries</h3>
<div class="section" id="using-union">
<h4>Using UNION</h4>
<pre class="code sql"><a name="rest_code_e54c65c848334f3cb2bd553f30b43077-1"></a><span class="k">select</span> <span class="n">cust_name</span><span class="p">,</span> <span class="n">cust_contact</span><span class="p">,</span> <span class="n">cust_state</span><span class="p">,</span> <span class="n">cust_email</span>
<a name="rest_code_e54c65c848334f3cb2bd553f30b43077-2"></a><span class="k">from</span> <span class="n">Customers</span>
<a name="rest_code_e54c65c848334f3cb2bd553f30b43077-3"></a><span class="k">where</span> <span class="n">cust_state</span> <span class="k">in</span> <span class="p">(</span><span class="ss">"il"</span><span class="p">,</span> <span class="ss">"in"</span><span class="p">,</span> <span class="ss">"mi"</span><span class="p">)</span>
<a name="rest_code_e54c65c848334f3cb2bd553f30b43077-4"></a><span class="k">union</span>
<a name="rest_code_e54c65c848334f3cb2bd553f30b43077-5"></a><span class="k">select</span> <span class="n">cust_name</span><span class="p">,</span> <span class="n">cust_contact</span><span class="p">,</span> <span class="n">ucust_state</span><span class="p">,</span>  <span class="n">cust_email</span>
<a name="rest_code_e54c65c848334f3cb2bd553f30b43077-6"></a><span class="k">from</span> <span class="n">Customers</span>
<a name="rest_code_e54c65c848334f3cb2bd553f30b43077-7"></a><span class="k">where</span> <span class="n">cust_name</span> <span class="o">=</span> <span class="ss">"Fun4All"</span><span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_f523defbb2f84530988b6fe62d7eee4e-1"></a><span class="k">select</span> <span class="n">cust_name</span><span class="p">,</span> <span class="n">cust_contact</span><span class="p">,</span> <span class="n">cust_email</span>
<a name="rest_code_f523defbb2f84530988b6fe62d7eee4e-2"></a><span class="k">from</span> <span class="n">customers</span>
<a name="rest_code_f523defbb2f84530988b6fe62d7eee4e-3"></a><span class="k">where</span> <span class="n">cust_state</span> <span class="k">in</span> <span class="p">(</span><span class="ss">"il"</span><span class="p">,</span> <span class="ss">"in"</span><span class="p">,</span> <span class="ss">"mi"</span><span class="p">)</span>
<a name="rest_code_f523defbb2f84530988b6fe62d7eee4e-4"></a><span class="k">or</span> <span class="n">cust_name</span> <span class="o">=</span> <span class="ss">"fun4all"</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="union-rules">
<h4>UNION Rules</h4>
<p>As you can see, unions are very easy to use. But there are a few rules governing exactly which can be combined:</p>
<ol class="arabic simple">
<li><p>A UNION must be composed of two or more SELECT statements, each separated by the keyword UNION (so, if combining four SELECT statements there would be three UNION keywords used).</p></li>
<li><p>Each query in a UNION must contain the same columns, expressions, or aggregate functions (and some DBMSs even require that columns be listed in the same order).</p></li>
<li><p>Column datatypes must be compatible: They need not be the exact same type, but they must be of a type that the DBMS can implicitly convert (for example, different numeric types or different date types).</p></li>
</ol>
<p>Aside from these basic rules and restrictions, unions can be used for any data retrieval tasks.</p>
</div>
<div class="section" id="including-or-eliminating-duplicate-rows">
<h4>Including or Eliminating Duplicate Rows</h4>
<pre class="code sql"><a name="rest_code_6ecfdac38161422bba57fc0260cc8a7a-1"></a><span class="k">select</span> <span class="n">cust_name</span><span class="p">,</span> <span class="n">cust_contact</span><span class="p">,</span> <span class="n">cust_email</span> <span class="k">from</span> <span class="n">Customers</span>
<a name="rest_code_6ecfdac38161422bba57fc0260cc8a7a-2"></a><span class="k">where</span> <span class="n">cust_state</span>  <span class="k">in</span> <span class="p">(</span><span class="ss">"il"</span><span class="p">,</span> <span class="ss">"in"</span><span class="p">,</span> <span class="ss">"mi"</span><span class="p">)</span>
<a name="rest_code_6ecfdac38161422bba57fc0260cc8a7a-3"></a><span class="k">union</span> <span class="k">all</span>
<a name="rest_code_6ecfdac38161422bba57fc0260cc8a7a-4"></a><span class="k">select</span> <span class="n">cust_name</span><span class="p">,</span> <span class="n">cust_contact</span><span class="p">,</span> <span class="n">cust_email</span>
<a name="rest_code_6ecfdac38161422bba57fc0260cc8a7a-5"></a><span class="k">from</span> <span class="n">Customers</span>
<a name="rest_code_6ecfdac38161422bba57fc0260cc8a7a-6"></a><span class="k">where</span> <span class="n">cust_name</span> <span class="o">=</span> <span class="ss">"fun4all"</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="sorting-combined-query-results">
<h4>Sorting Combined Query Results</h4>
<pre class="code sql"><a name="rest_code_a4eb942d960e475cba1613e7f30dceb4-1"></a><span class="k">select</span> <span class="n">cust_name</span><span class="p">,</span> <span class="n">cust_contact</span><span class="p">,</span> <span class="n">cust_email</span>
<a name="rest_code_a4eb942d960e475cba1613e7f30dceb4-2"></a><span class="k">from</span> <span class="n">Customers</span>
<a name="rest_code_a4eb942d960e475cba1613e7f30dceb4-3"></a><span class="k">where</span> <span class="n">cust_state</span>  <span class="k">in</span> <span class="p">(</span><span class="ss">"il"</span><span class="p">,</span> <span class="ss">"in"</span><span class="p">,</span> <span class="ss">"mi"</span><span class="p">)</span>
<a name="rest_code_a4eb942d960e475cba1613e7f30dceb4-4"></a><span class="k">union</span> <span class="k">all</span>
<a name="rest_code_a4eb942d960e475cba1613e7f30dceb4-5"></a><span class="k">select</span> <span class="n">cust_name</span><span class="p">,</span> <span class="n">cust_contact</span><span class="p">,</span> <span class="n">cust_email</span>
<a name="rest_code_a4eb942d960e475cba1613e7f30dceb4-6"></a><span class="k">from</span> <span class="n">Customers</span>
<a name="rest_code_a4eb942d960e475cba1613e7f30dceb4-7"></a><span class="k">where</span> <span class="n">cust_name</span> <span class="o">=</span> <span class="ss">"fun4all"</span> <span class="k">order</span> <span class="k">by</span> <span class="n">cust_name</span><span class="p">,</span> <span class="n">cust_contact</span><span class="p">;</span>
</pre>
</div>
</div>
</div>
<div class="section" id="using-views">
<h2>18.Using Views</h2>
<p>介绍view的三个基本应用</p>
<ol class="arabic simple">
<li><p>simplify complex joins</p></li>
<li><p>Reformat data</p></li>
<li><p>Filter unwanted data</p></li>
</ol>
<div class="section" id="understanding-views">
<h3>Understanding Views</h3>
<pre class="code sql"><a name="rest_code_e78e61f7755d4ae5831ef24b9f43b757-1"></a><span class="k">SELECT</span> <span class="n">cust_name</span><span class="p">,</span> <span class="n">cust_contact</span>
<a name="rest_code_e78e61f7755d4ae5831ef24b9f43b757-2"></a><span class="k">FROM</span> <span class="n">Customers</span><span class="p">,</span> <span class="n">Orders</span><span class="p">,</span> <span class="n">OrderItems</span>
<a name="rest_code_e78e61f7755d4ae5831ef24b9f43b757-3"></a><span class="k">WHERE</span> <span class="n">Customers</span><span class="p">.</span><span class="n">cust_id</span> <span class="o">=</span> <span class="n">Orders</span><span class="p">.</span><span class="n">cust_id</span>
<a name="rest_code_e78e61f7755d4ae5831ef24b9f43b757-4"></a><span class="k">AND</span> <span class="n">OrderItems</span><span class="p">.</span><span class="n">order_num</span> <span class="o">=</span> <span class="n">Orders</span><span class="p">.</span><span class="n">order_num</span>
<a name="rest_code_e78e61f7755d4ae5831ef24b9f43b757-5"></a><span class="k">AND</span> <span class="n">prod_id</span> <span class="o">=</span> <span class="s1">'RGAN01'</span><span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_2e482fd51ad24e90a34f34cd0a8b5f78-1"></a><span class="k">SELECT</span> <span class="n">cust_name</span><span class="p">,</span> <span class="n">cust_contact</span>
<a name="rest_code_2e482fd51ad24e90a34f34cd0a8b5f78-2"></a><span class="k">FROM</span> <span class="n">ProductCustomers</span>
<a name="rest_code_2e482fd51ad24e90a34f34cd0a8b5f78-3"></a><span class="k">WHERE</span> <span class="n">prod_id</span> <span class="o">=</span> <span class="s1">'RGAN01'</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="creating-views">
<h3>Creating Views</h3>
<div class="section" id="using-views-to-simplify-complex-joins">
<h4>Using Views to Simplify Complex Joins</h4>
<pre class="code sql"><a name="rest_code_b8ea8b8ebae2404d96af5e0a1da13256-1"></a><span class="k">create</span> <span class="k">view</span>  <span class="n">ProductCustomers</span> <span class="k">as</span>
<a name="rest_code_b8ea8b8ebae2404d96af5e0a1da13256-2"></a><span class="k">select</span> <span class="n">cust_name</span><span class="p">,</span><span class="n">cust_contact</span><span class="p">,</span> <span class="n">prod_id</span>
<a name="rest_code_b8ea8b8ebae2404d96af5e0a1da13256-3"></a><span class="k">from</span> <span class="n">Customers</span><span class="p">,</span> <span class="n">Orders</span><span class="p">,</span> <span class="n">OrderItems</span>
<a name="rest_code_b8ea8b8ebae2404d96af5e0a1da13256-4"></a><span class="k">where</span> <span class="n">Customers</span><span class="p">.</span><span class="n">cust_id</span> <span class="o">=</span> <span class="n">Orders</span><span class="p">.</span><span class="n">cust_id</span>
<a name="rest_code_b8ea8b8ebae2404d96af5e0a1da13256-5"></a><span class="k">and</span> <span class="n">Orders</span><span class="p">.</span><span class="n">order_num</span> <span class="o">=</span> <span class="n">OrderItems</span><span class="p">.</span><span class="n">order_num</span><span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_402a76fb427c428b8faf988eda72d4a2-1"></a><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">ProductCustomers</span><span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_d02467ca2525492983bebd829c4732d3-1"></a><span class="k">select</span> <span class="n">cust_name</span><span class="p">,</span> <span class="n">cust_contact</span>
<a name="rest_code_d02467ca2525492983bebd829c4732d3-2"></a><span class="k">from</span> <span class="n">ProductCustomers</span>
<a name="rest_code_d02467ca2525492983bebd829c4732d3-3"></a><span class="k">where</span> <span class="n">prod_id</span> <span class="o">=</span> <span class="ss">"rgan01"</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="using-views-to-reformat-retrieved-data">
<h4>Using Views to Reformat Retrieved Data</h4>
<pre class="code sql"><a name="rest_code_ae29306b0dca470783db4d62e6f05a4e-1"></a><span class="k">select</span> <span class="n">concat</span><span class="p">(</span><span class="k">trim</span><span class="p">(</span><span class="n">vend_name</span><span class="p">),</span> <span class="ss">" ("</span><span class="p">,</span> <span class="k">trim</span><span class="p">(</span><span class="n">vend_country</span><span class="p">),</span> <span class="ss">") "</span><span class="p">)</span> <span class="k">as</span> <span class="n">vend_title</span>
<a name="rest_code_ae29306b0dca470783db4d62e6f05a4e-2"></a><span class="k">from</span> <span class="n">Vendors</span> <span class="k">order</span> <span class="k">by</span> <span class="n">vend_name</span><span class="p">;</span>
</pre>
<table>
<colgroup><col style="width: 100%"></colgroup>
<thead><tr>
<th class="head"><p>vend<sub>title</sub></p></th>
</tr></thead>
<tbody>
<tr>
<td><p>Bear Emporium (USA)</p></td>
</tr>
<tr>
<td><p>Bears R Us (USA)</p></td>
</tr>
<tr>
<td><p>Doll House Inc. (USA)</p></td>
</tr>
<tr>
<td><p>Fun and Games (England)</p></td>
</tr>
<tr>
<td><p>Furball Inc. (USA)</p></td>
</tr>
<tr>
<td><p>Jouets et ours (France)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="using-views-to-filter-unwanted-data">
<h4>Using Views to Filter Unwanted Data</h4>
<pre class="code sql"><a name="rest_code_5fcb7a9cc7fe4066b6df10abcff1c931-1"></a><span class="k">CREATE</span> <span class="k">VIEW</span> <span class="n">CustomerEMailList</span> <span class="k">AS</span>
<a name="rest_code_5fcb7a9cc7fe4066b6df10abcff1c931-2"></a><span class="k">SELECT</span> <span class="n">cust_id</span><span class="p">,</span> <span class="n">cust_name</span><span class="p">,</span> <span class="n">cust_email</span>
<a name="rest_code_5fcb7a9cc7fe4066b6df10abcff1c931-3"></a><span class="k">FROM</span> <span class="n">Customers</span>
<a name="rest_code_5fcb7a9cc7fe4066b6df10abcff1c931-4"></a><span class="k">WHERE</span> <span class="n">cust_email</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_e865c6232169435eac5b7d01e87a8611-1"></a><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">CustomerEMailList</span><span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_5eca637ee78e4c05b77ee550173f0ecb-1"></a><span class="k">create</span> <span class="k">view</span> <span class="n">OrderItemsExpanded</span> <span class="k">as</span>
<a name="rest_code_5eca637ee78e4c05b77ee550173f0ecb-2"></a><span class="k">select</span> <span class="n">order_num</span><span class="p">,</span> <span class="n">prod_id</span><span class="p">,</span> <span class="n">quantity</span><span class="p">,</span> <span class="n">item_price</span><span class="p">,</span> <span class="n">quantity</span><span class="o">*</span><span class="n">item_price</span> <span class="k">as</span> <span class="n">expanded_price</span> <span class="k">from</span> <span class="n">OrderItems</span> <span class="k">where</span> <span class="n">order_num</span> <span class="o">=</span> <span class="mi">20008</span><span class="p">;</span>
</pre>
</div>
</div>
</div>
<div class="section" id="inserting-data">
<h2>15.Inserting Data</h2>
<p>总结 讲到了最关键的一点, 如何增加数据. insert completed rows, partial rows, insert retrieved data, copy</p>
<div class="section" id="understanding-data-insertion">
<h3>Understanding Data Insertion</h3>
<div class="section" id="inserting-complete-rows">
<h4>Inserting Complete Rows</h4>
<pre class="code sql"><a name="rest_code_b1bc858d5b8a4d2280b31cdab9d9141d-1"></a><span class="k">insert</span> <span class="k">into</span> <span class="n">Customers</span>
<a name="rest_code_b1bc858d5b8a4d2280b31cdab9d9141d-2"></a><span class="k">values</span> <span class="p">(</span><span class="ss">"1000000006"</span><span class="p">,</span><span class="ss">"toy land"</span><span class="p">,</span> <span class="ss">"123 any street"</span><span class="p">,</span> <span class="ss">"New York"</span><span class="p">,</span> <span class="ss">"NY"</span><span class="p">,</span> <span class="ss">"11111"</span><span class="p">,</span> <span class="ss">"USA"</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">);</span>
</pre>
<pre class="code sql"><a name="rest_code_54dab1e311a84d5f8413c622e3daae79-1"></a><span class="k">insert</span> <span class="k">into</span> <span class="n">Customers</span> <span class="p">(</span><span class="n">cust_id</span><span class="p">,</span> <span class="n">cust_name</span><span class="p">,</span> <span class="n">cust_address</span><span class="p">,</span> <span class="n">cust_city</span><span class="p">,</span> <span class="n">cust_state</span><span class="p">,</span> <span class="n">cust_zip</span><span class="p">,</span> <span class="n">cust_country</span><span class="p">,</span> <span class="n">cust_contact</span><span class="p">,</span>  <span class="n">cust_email</span><span class="p">)</span> <span class="k">values</span> <span class="p">(</span><span class="ss">"1000000012"</span><span class="p">,</span> <span class="ss">"boy land"</span><span class="p">,</span> <span class="ss">"456 any street"</span><span class="p">,</span> <span class="ss">"New York"</span><span class="p">,</span> <span class="ss">"NY"</span><span class="p">,</span> <span class="ss">"11111"</span><span class="p">,</span> <span class="ss">"USA"</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">);</span>
</pre>
<pre class="code sql"><a name="rest_code_e50cfcf32eb648b289838e86f1b4246a-1"></a><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">Customers</span><span class="p">(</span><span class="n">cust_id</span><span class="p">,</span>
<a name="rest_code_e50cfcf32eb648b289838e86f1b4246a-2"></a>                      <span class="n">cust_contact</span><span class="p">,</span>
<a name="rest_code_e50cfcf32eb648b289838e86f1b4246a-3"></a>                      <span class="n">cust_email</span><span class="p">,</span>
<a name="rest_code_e50cfcf32eb648b289838e86f1b4246a-4"></a>                      <span class="n">cust_name</span><span class="p">,</span>
<a name="rest_code_e50cfcf32eb648b289838e86f1b4246a-5"></a>                      <span class="n">cust_address</span><span class="p">,</span>
<a name="rest_code_e50cfcf32eb648b289838e86f1b4246a-6"></a>                      <span class="n">cust_city</span><span class="p">,</span>
<a name="rest_code_e50cfcf32eb648b289838e86f1b4246a-7"></a>                      <span class="n">cust_state</span><span class="p">,</span>
<a name="rest_code_e50cfcf32eb648b289838e86f1b4246a-8"></a>                      <span class="n">cust_zip</span><span class="p">)</span>
<a name="rest_code_e50cfcf32eb648b289838e86f1b4246a-9"></a><span class="k">VALUES</span><span class="p">(</span><span class="s1">'1000000006'</span><span class="p">,</span>
<a name="rest_code_e50cfcf32eb648b289838e86f1b4246a-10"></a>       <span class="k">NULL</span><span class="p">,</span>
<a name="rest_code_e50cfcf32eb648b289838e86f1b4246a-11"></a>       <span class="k">NULL</span><span class="p">,</span>
<a name="rest_code_e50cfcf32eb648b289838e86f1b4246a-12"></a>       <span class="s1">'Toy Land'</span><span class="p">,</span>
<a name="rest_code_e50cfcf32eb648b289838e86f1b4246a-13"></a>       <span class="s1">'123 Any Street'</span><span class="p">,</span>
<a name="rest_code_e50cfcf32eb648b289838e86f1b4246a-14"></a>       <span class="s1">'New York'</span><span class="p">,</span>
<a name="rest_code_e50cfcf32eb648b289838e86f1b4246a-15"></a>       <span class="s1">'NY'</span><span class="p">,</span>
<a name="rest_code_e50cfcf32eb648b289838e86f1b4246a-16"></a>       <span class="s1">'11111'</span><span class="p">);</span>
</pre>
</div>
<div class="section" id="inserting-partial-rows">
<h4>Inserting Partial Rows</h4>
<pre class="code sql"><a name="rest_code_b1a144e78f484a6fac1032eb1d3ede36-1"></a><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">Customers</span><span class="p">(</span><span class="n">cust_id</span><span class="p">,</span>
<a name="rest_code_b1a144e78f484a6fac1032eb1d3ede36-2"></a>                      <span class="n">cust_name</span><span class="p">,</span>
<a name="rest_code_b1a144e78f484a6fac1032eb1d3ede36-3"></a>                      <span class="n">cust_address</span><span class="p">,</span>
<a name="rest_code_b1a144e78f484a6fac1032eb1d3ede36-4"></a>                      <span class="n">cust_city</span><span class="p">,</span>
<a name="rest_code_b1a144e78f484a6fac1032eb1d3ede36-5"></a>                      <span class="n">cust_state</span><span class="p">,</span>
<a name="rest_code_b1a144e78f484a6fac1032eb1d3ede36-6"></a>                      <span class="n">cust_zip</span><span class="p">,</span>
<a name="rest_code_b1a144e78f484a6fac1032eb1d3ede36-7"></a>                      <span class="n">cust_country</span><span class="p">)</span>
<a name="rest_code_b1a144e78f484a6fac1032eb1d3ede36-8"></a><span class="k">VALUES</span><span class="p">(</span><span class="s1">'1000000006'</span><span class="p">,</span>
<a name="rest_code_b1a144e78f484a6fac1032eb1d3ede36-9"></a>       <span class="s1">'Toy Land'</span><span class="p">,</span>
<a name="rest_code_b1a144e78f484a6fac1032eb1d3ede36-10"></a>       <span class="s1">'123 Any Street'</span><span class="p">,</span>
<a name="rest_code_b1a144e78f484a6fac1032eb1d3ede36-11"></a>       <span class="s1">'New York'</span><span class="p">,</span>
<a name="rest_code_b1a144e78f484a6fac1032eb1d3ede36-12"></a>       <span class="s1">'NY'</span><span class="p">,</span>
<a name="rest_code_b1a144e78f484a6fac1032eb1d3ede36-13"></a>       <span class="s1">'11111'</span><span class="p">,</span>
<a name="rest_code_b1a144e78f484a6fac1032eb1d3ede36-14"></a>       <span class="s1">'USA'</span><span class="p">);</span>
</pre>
</div>
<div class="section" id="inserting-retrieved-data">
<h4>Inserting Retrieved Data</h4>
<pre class="code sql"><a name="rest_code_f4b66f7c418c44bf9c140f108937477a-1"></a><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">Customers</span><span class="p">(</span><span class="n">cust_id</span><span class="p">,</span>
<a name="rest_code_f4b66f7c418c44bf9c140f108937477a-2"></a>                      <span class="n">cust_contact</span><span class="p">,</span>
<a name="rest_code_f4b66f7c418c44bf9c140f108937477a-3"></a>                      <span class="n">cust_email</span><span class="p">,</span>
<a name="rest_code_f4b66f7c418c44bf9c140f108937477a-4"></a>                      <span class="n">cust_name</span><span class="p">,</span>
<a name="rest_code_f4b66f7c418c44bf9c140f108937477a-5"></a>                      <span class="n">cust_address</span><span class="p">,</span>
<a name="rest_code_f4b66f7c418c44bf9c140f108937477a-6"></a>                      <span class="n">cust_city</span><span class="p">,</span>
<a name="rest_code_f4b66f7c418c44bf9c140f108937477a-7"></a>                      <span class="n">cust_state</span><span class="p">,</span>
<a name="rest_code_f4b66f7c418c44bf9c140f108937477a-8"></a>                      <span class="n">cust_zip</span><span class="p">,</span>
<a name="rest_code_f4b66f7c418c44bf9c140f108937477a-9"></a>                      <span class="n">cust_country</span><span class="p">)</span>
<a name="rest_code_f4b66f7c418c44bf9c140f108937477a-10"></a><span class="k">SELECT</span> <span class="n">cust_id</span><span class="p">,</span>
<a name="rest_code_f4b66f7c418c44bf9c140f108937477a-11"></a>       <span class="n">cust_contact</span><span class="p">,</span>
<a name="rest_code_f4b66f7c418c44bf9c140f108937477a-12"></a>       <span class="n">cust_email</span><span class="p">,</span>
<a name="rest_code_f4b66f7c418c44bf9c140f108937477a-13"></a>       <span class="n">cust_name</span><span class="p">,</span>
<a name="rest_code_f4b66f7c418c44bf9c140f108937477a-14"></a>       <span class="n">cust_address</span><span class="p">,</span>
<a name="rest_code_f4b66f7c418c44bf9c140f108937477a-15"></a>       <span class="n">cust_city</span><span class="p">,</span>
<a name="rest_code_f4b66f7c418c44bf9c140f108937477a-16"></a>       <span class="n">cust_state</span><span class="p">,</span>
<a name="rest_code_f4b66f7c418c44bf9c140f108937477a-17"></a>       <span class="n">cust_zip</span><span class="p">,</span>
<a name="rest_code_f4b66f7c418c44bf9c140f108937477a-18"></a>       <span class="n">cust_country</span>
<a name="rest_code_f4b66f7c418c44bf9c140f108937477a-19"></a>       <span class="k">FROM</span> <span class="n">CustNew</span><span class="p">;</span>
</pre>
</div>
</div>
<div class="section" id="copying-from-one-table-to-another">
<h3>Copying from One Table to Another</h3>
<pre class="code sql"><a name="rest_code_4f361ddbeb3a47ee838858750532d4e7-1"></a><span class="k">SELECT</span> <span class="o">*</span> <span class="k">INTO</span> <span class="n">CustCopy</span> <span class="k">FROM</span> <span class="n">Customers</span><span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_a357867ce9014af0b66618b82a390ff1-1"></a><span class="k">create</span> <span class="k">table</span> <span class="n">custcopy</span> <span class="k">as</span>
<a name="rest_code_a357867ce9014af0b66618b82a390ff1-2"></a><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">Customers</span><span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_f324584c2cdb4207a4112173d43940f4-1"></a><span class="k">select</span> <span class="n">cust_id</span><span class="p">,</span> <span class="n">cust_name</span> <span class="k">from</span> <span class="n">custcopy</span><span class="p">;</span>
</pre>
</div>
</div>
<div class="section" id="updating-and-deleting-data">
<h2>16.Updating and Deleting Data</h2>
<p>update table set #multiple 没有comma delete from</p>
<div class="section" id="updating-data">
<h3>Updating Data</h3>
<pre class="code sql"><a name="rest_code_812b82ee8f604df782356315f26ffc45-1"></a><span class="k">update</span> <span class="n">Customers</span>
<a name="rest_code_812b82ee8f604df782356315f26ffc45-2"></a><span class="k">set</span> <span class="n">cust_email</span> <span class="o">=</span> <span class="ss">"kim@thetoystore.com"</span>
<a name="rest_code_812b82ee8f604df782356315f26ffc45-3"></a><span class="k">where</span> <span class="n">cust_id</span> <span class="o">=</span> <span class="ss">"1000000005"</span><span class="p">;</span>
</pre>
<p><code class="docutils literal">SET cust_email = 'kim@thetoystore.com'</code></p>
<pre class="code sql"><a name="rest_code_a1102b898f8148e8add72adf4a697aa2-1"></a><span class="k">UPDATE</span> <span class="n">Customers</span>
<a name="rest_code_a1102b898f8148e8add72adf4a697aa2-2"></a><span class="k">SET</span> <span class="n">cust_contact</span> <span class="o">=</span> <span class="s1">'Sam Roberts'</span><span class="p">,</span>
<a name="rest_code_a1102b898f8148e8add72adf4a697aa2-3"></a><span class="n">cust_email</span> <span class="o">=</span> <span class="s1">'sam@toyland.com'</span>
<a name="rest_code_a1102b898f8148e8add72adf4a697aa2-4"></a><span class="k">WHERE</span> <span class="n">cust_id</span> <span class="o">=</span> <span class="s1">'1000000006'</span><span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_4740e69c86d44a57854f8af0091e4683-1"></a><span class="k">UPDATE</span> <span class="n">Customers</span>
<a name="rest_code_4740e69c86d44a57854f8af0091e4683-2"></a><span class="k">SET</span> <span class="n">cust_email</span> <span class="o">=</span> <span class="k">NULL</span>
<a name="rest_code_4740e69c86d44a57854f8af0091e4683-3"></a><span class="k">WHERE</span> <span class="n">cust_id</span> <span class="o">=</span> <span class="s1">'1000000005'</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="deleting-data">
<h3>Deleting Data</h3>
<pre class="code sql"><a name="rest_code_4ac2744c48324bef8b7d28dbe9221818-1"></a><span class="k">DELETE</span>
<a name="rest_code_4ac2744c48324bef8b7d28dbe9221818-2"></a><span class="k">FROM</span> <span class="n">Customers</span>
<a name="rest_code_4ac2744c48324bef8b7d28dbe9221818-3"></a><span class="k">WHERE</span> <span class="n">cust_id</span> <span class="o">=</span> <span class="s1">'1000000006'</span><span class="p">;</span>
</pre>
</div>
</div>
<div class="section" id="creating-and-manipulating-tables">
<h2>17.Creating and Manipulating Tables</h2>
<p>总结 create table, work with null, default value, alter table drop table</p>
<div class="section" id="creating-tables">
<h3>Creating Tables</h3>
<div class="section" id="basic-table-creation">
<h4>Basic Table Creation</h4>
<pre class="code sql"><a name="rest_code_da832382abe44c9b8f61054cbc156240-1"></a><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">Products3</span>
<a name="rest_code_da832382abe44c9b8f61054cbc156240-2"></a><span class="p">(</span>
<a name="rest_code_da832382abe44c9b8f61054cbc156240-3"></a>    <span class="n">prod_id</span> <span class="nb">CHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
<a name="rest_code_da832382abe44c9b8f61054cbc156240-4"></a>    <span class="n">vend_id</span> <span class="nb">CHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
<a name="rest_code_da832382abe44c9b8f61054cbc156240-5"></a>    <span class="n">prod_name</span> <span class="nb">CHAR</span><span class="p">(</span><span class="mi">254</span><span class="p">)</span>  <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
<a name="rest_code_da832382abe44c9b8f61054cbc156240-6"></a>    <span class="n">prod_price</span> <span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
<a name="rest_code_da832382abe44c9b8f61054cbc156240-7"></a>    <span class="n">prod_desc</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>  <span class="k">NULL</span>
<a name="rest_code_da832382abe44c9b8f61054cbc156240-8"></a><span class="p">);</span>
</pre>
</div>
<div class="section" id="working-with-null-values">
<h4>Working With Null Values</h4>
<pre class="code sql"><a name="rest_code_f45e421907c74055bc8c53361f841bfc-1"></a><span class="k">create</span> <span class="k">table</span> <span class="n">Contracts2</span>
<a name="rest_code_f45e421907c74055bc8c53361f841bfc-2"></a><span class="p">(</span><span class="n">contract_num</span> <span class="nb">integer</span> <span class="k">not</span> <span class="k">null</span><span class="p">,</span>
<a name="rest_code_f45e421907c74055bc8c53361f841bfc-3"></a><span class="n">contract_date</span> <span class="n">datetime</span> <span class="k">not</span> <span class="k">null</span><span class="p">,</span>
<a name="rest_code_f45e421907c74055bc8c53361f841bfc-4"></a><span class="n">contract_id</span> <span class="nb">char</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="k">not</span> <span class="k">null</span><span class="p">);</span>
</pre>
<pre class="code sql"><a name="rest_code_80f36ee5f68d46f4a5caef5117ea9fbf-1"></a><span class="k">create</span> <span class="k">table</span> <span class="n">Suppliers</span> <span class="p">(</span>
<a name="rest_code_80f36ee5f68d46f4a5caef5117ea9fbf-2"></a><span class="n">supplier_id</span> <span class="nb">char</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="k">not</span> <span class="k">null</span><span class="p">,</span>
<a name="rest_code_80f36ee5f68d46f4a5caef5117ea9fbf-3"></a><span class="n">supplier_name</span> <span class="nb">char</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="k">not</span> <span class="k">null</span><span class="p">,</span>
<a name="rest_code_80f36ee5f68d46f4a5caef5117ea9fbf-4"></a><span class="n">supplier_address</span> <span class="nb">char</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<a name="rest_code_80f36ee5f68d46f4a5caef5117ea9fbf-5"></a><span class="n">supplier_city</span> <span class="nb">char</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<a name="rest_code_80f36ee5f68d46f4a5caef5117ea9fbf-6"></a><span class="n">supplier_state</span> <span class="nb">char</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<a name="rest_code_80f36ee5f68d46f4a5caef5117ea9fbf-7"></a><span class="n">supplier_zip</span> <span class="nb">char</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
<a name="rest_code_80f36ee5f68d46f4a5caef5117ea9fbf-8"></a><span class="n">supplier_country</span> <span class="nb">char</span><span class="p">(</span><span class="mi">50</span><span class="p">));</span>
</pre>
</div>
<div class="section" id="specifying-default-values">
<h4>Specifying Default Values</h4>
<pre class="code sql"><a name="rest_code_1111bd7047cc4b1e93f58c3a92c6d8da-1"></a><span class="k">create</span> <span class="k">table</span> <span class="n">ContractItems</span>
<a name="rest_code_1111bd7047cc4b1e93f58c3a92c6d8da-2"></a><span class="p">(</span>
<a name="rest_code_1111bd7047cc4b1e93f58c3a92c6d8da-3"></a><span class="n">contract_num</span> <span class="nb">integer</span> <span class="k">not</span> <span class="k">null</span><span class="p">,</span>
<a name="rest_code_1111bd7047cc4b1e93f58c3a92c6d8da-4"></a><span class="n">contract_item</span> <span class="nb">integer</span> <span class="k">not</span> <span class="k">null</span><span class="p">,</span>
<a name="rest_code_1111bd7047cc4b1e93f58c3a92c6d8da-5"></a><span class="n">prod_id</span> <span class="nb">char</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="k">not</span> <span class="k">null</span><span class="p">,</span>
<a name="rest_code_1111bd7047cc4b1e93f58c3a92c6d8da-6"></a><span class="n">quantity</span> <span class="nb">integer</span> <span class="k">not</span> <span class="k">null</span> <span class="k">default</span> <span class="mi">1</span><span class="p">,</span>
<a name="rest_code_1111bd7047cc4b1e93f58c3a92c6d8da-7"></a><span class="n">item_price</span> <span class="nb">decimal</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="k">not</span> <span class="k">null</span>
<a name="rest_code_1111bd7047cc4b1e93f58c3a92c6d8da-8"></a><span class="p">);</span>
</pre>
<div class="figure">
<img alt="Screen Shot 2018-08-13 at 11.11.20 AM" src="http://heropublic.oss-cn-beijing.aliyuncs.com/031136.png"><p class="caption">Screen Shot 2018-08-13 at 11.11.20 AM</p>
</div>
</div>
</div>
<div class="section" id="updating-tables">
<h3>Updating Tables</h3>
<pre class="code sql"><a name="rest_code_dd887423f3a9479f931dc3237e0838a4-1"></a><span class="k">alter</span> <span class="k">table</span> <span class="n">Suppliers</span> <span class="k">add</span> <span class="n">supplier_phone</span> <span class="nb">char</span><span class="p">(</span><span class="mi">20</span><span class="p">);</span>
</pre>
<pre class="code sql"><a name="rest_code_6a60737476c444c297375a033a693001-1"></a><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">Suppliers</span><span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_572f23f9fb674c94a1ad235f429c92d0-1"></a><span class="k">alter</span> <span class="k">table</span> <span class="n">Suppliers</span>
<a name="rest_code_572f23f9fb674c94a1ad235f429c92d0-2"></a><span class="k">drop</span> <span class="k">column</span> <span class="n">supplier_phone</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="deleting-tables">
<h3>Deleting Tables</h3>
<pre class="code sql"><a name="rest_code_92f9df13f39c4e9686454375a51d533b-1"></a><span class="k">DROP</span> <span class="k">TABLE</span> <span class="n">Suppliers</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="renaming-tables">
<h3>Renaming Tables</h3>
</div>
<div class="section" id="summary">
<h3>Summary</h3>
<p>In this lesson, you learned several new SQL statements. CREATE TABLE is used to create new tables, ALTER TABLE is used to change table columns (or other objects like constraints or indexes), and DROP TABLE is used to completely delete a table. These statements should be used with extreme caution, and only after backups have been made. As the exact syntax of each of these statements varies from one DBMS to another, you should consult your own DBMS documentation for more information.</p>
<blockquote>
<p>Foreign-Key首先是数据类型其次才是connecting point</p>
</blockquote>
</div>
</div>
<div class="section" id="working-with-stored-procedures">
<h2>19.Working with Stored Procedures</h2>
<div class="section" id="executing-stored-procedures">
<h3>Executing Stored Procedures</h3>
<pre class="code sql"><a name="rest_code_be81b8d0787544fcbfe006a7d200af19-1"></a><span class="k">EXECUTE</span> <span class="n">AddNewProduct</span><span class="p">(</span><span class="s1">'JTS01'</span><span class="p">,</span>
<a name="rest_code_be81b8d0787544fcbfe006a7d200af19-2"></a>                      <span class="s1">'Stuffed Eiffel Tower'</span><span class="p">,</span>
<a name="rest_code_be81b8d0787544fcbfe006a7d200af19-3"></a>                      <span class="mi">6</span><span class="p">.</span><span class="mi">49</span><span class="p">,</span>
<a name="rest_code_be81b8d0787544fcbfe006a7d200af19-4"></a>                      <span class="s1">'Plush stuffed toy with the text La Tour Eiffel in red white and blue'</span><span class="p">);</span>
</pre>
</div>
<div class="section" id="creating-stored-procedures">
<h3>Creating Stored Procedures</h3>
<pre class="code sql"><a name="rest_code_dc7002cd869f4aca99ccc8f742838590-1"></a><span class="k">CREATE</span> <span class="k">PROCEDURE</span> <span class="n">MailingListCount</span> <span class="p">(</span>
<a name="rest_code_dc7002cd869f4aca99ccc8f742838590-2"></a><span class="n">ListCount</span> <span class="k">OUT</span> <span class="nb">INTEGER</span> <span class="p">)</span>
<a name="rest_code_dc7002cd869f4aca99ccc8f742838590-3"></a><span class="k">IS</span>
<a name="rest_code_dc7002cd869f4aca99ccc8f742838590-4"></a><span class="n">v_rows</span> <span class="nb">INTEGER</span><span class="p">;</span>
<a name="rest_code_dc7002cd869f4aca99ccc8f742838590-5"></a><span class="k">BEGIN</span>
<a name="rest_code_dc7002cd869f4aca99ccc8f742838590-6"></a>    <span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">INTO</span> <span class="n">v_rows</span>
<a name="rest_code_dc7002cd869f4aca99ccc8f742838590-7"></a>    <span class="k">FROM</span> <span class="n">Customers</span>
<a name="rest_code_dc7002cd869f4aca99ccc8f742838590-8"></a>    <span class="k">WHERE</span> <span class="k">NOT</span> <span class="n">cust_email</span> <span class="k">IS</span> <span class="k">NULL</span><span class="p">;</span>
<a name="rest_code_dc7002cd869f4aca99ccc8f742838590-9"></a>    <span class="n">ListCount</span> <span class="p">:</span><span class="o">=</span> <span class="n">v_rows</span><span class="p">;</span>
<a name="rest_code_dc7002cd869f4aca99ccc8f742838590-10"></a>    <span class="k">END</span><span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_63b112516a964260900e38770f513bc6-1"></a><span class="n">var</span> <span class="n">ReturnValue</span> <span class="nb">NUMBER</span>
<a name="rest_code_63b112516a964260900e38770f513bc6-2"></a><span class="k">EXEC</span> <span class="n">MailingListCount</span><span class="p">(:</span><span class="n">ReturnValue</span><span class="p">);</span>
<a name="rest_code_63b112516a964260900e38770f513bc6-3"></a><span class="k">SELECT</span> <span class="n">ReturnValue</span><span class="p">;</span>
</pre>
</div>
</div>
<div class="section" id="managing-transaction-processing">
<h2>20.Managing Transaction Processing</h2>
<div class="section" id="controlling-transactions">
<h3>Controlling Transactions</h3>
<div class="section" id="using-rollback">
<h4>Using Rollback</h4>
<pre class="code python"><a name="rest_code_061cfaac79a74337bad238b47c2be10b-1"></a><span class="n">DELETE</span> <span class="n">FROM</span> <span class="n">Orders</span><span class="p">;</span>
<a name="rest_code_061cfaac79a74337bad238b47c2be10b-2"></a><span class="n">ROLLBACK</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="using-commit">
<h4>Using Commit</h4>
<pre class="code python"><a name="rest_code_463a763daa134c22a9a6d553167e3f59-1"></a><span class="n">BEGIN</span> <span class="n">TRANSACTION</span>
<a name="rest_code_463a763daa134c22a9a6d553167e3f59-2"></a><span class="n">DELETE</span> <span class="n">OrderItems</span> <span class="n">WHERE</span> <span class="n">order_num</span> <span class="o">=</span> <span class="mi">12345</span>
<a name="rest_code_463a763daa134c22a9a6d553167e3f59-3"></a><span class="n">DELETE</span> <span class="n">Orders</span> <span class="n">WHERE</span> <span class="n">order_num</span> <span class="o">=</span> <span class="mi">12345</span>
<a name="rest_code_463a763daa134c22a9a6d553167e3f59-4"></a><span class="n">COMMIT</span> <span class="n">TRANSACTION</span>
</pre>
<pre class="code python"><a name="rest_code_5c47f8b7e3fd4970bfdda6d540b5751e-1"></a><span class="n">SET</span> <span class="n">TRANSACTION</span>
<a name="rest_code_5c47f8b7e3fd4970bfdda6d540b5751e-2"></a><span class="n">DELETE</span> <span class="n">OrderItems</span> <span class="n">WHERE</span> <span class="n">order_num</span> <span class="o">=</span> <span class="mi">12345</span><span class="p">;</span>
<a name="rest_code_5c47f8b7e3fd4970bfdda6d540b5751e-3"></a><span class="n">DELETE</span> <span class="n">Orders</span> <span class="n">WHERE</span> <span class="n">order_num</span> <span class="o">=</span> <span class="mi">12345</span><span class="p">;</span>
<a name="rest_code_5c47f8b7e3fd4970bfdda6d540b5751e-4"></a><span class="n">COMMIT</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="using-savepoints">
<h4>Using Savepoints</h4>
<pre class="code python"><a name="rest_code_9d575ec96143499b9e79f1f35eff9603-1"></a><span class="n">BEGIN</span> <span class="n">TRANSACTION</span>
<a name="rest_code_9d575ec96143499b9e79f1f35eff9603-2"></a><span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">Customers</span><span class="p">(</span><span class="n">cust_id</span><span class="p">,</span> <span class="n">cust_name</span><span class="p">)</span>
<a name="rest_code_9d575ec96143499b9e79f1f35eff9603-3"></a><span class="n">VALUES</span><span class="p">(</span><span class="s1">'1000000010'</span><span class="p">,</span> <span class="s1">'Toys Emporium'</span><span class="p">);</span>
<a name="rest_code_9d575ec96143499b9e79f1f35eff9603-4"></a><span class="n">SAVE</span> <span class="n">TRANSACTION</span> <span class="n">StartOrder</span><span class="p">;</span>
<a name="rest_code_9d575ec96143499b9e79f1f35eff9603-5"></a><span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">Orders</span><span class="p">(</span><span class="n">order_num</span><span class="p">,</span> <span class="n">order_date</span><span class="p">,</span> <span class="n">cust_id</span><span class="p">)</span> <span class="n">VALUES</span><span class="p">(</span><span class="mi">20100</span><span class="p">,</span><span class="s1">'2001/12/1'</span><span class="p">,</span><span class="s1">'1000000010'</span><span class="p">);</span>
<a name="rest_code_9d575ec96143499b9e79f1f35eff9603-6"></a><span class="n">IF</span> <span class="err">@</span><span class="nd">@ERROR</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span> <span class="n">ROLLBACK</span> <span class="n">TRANSACTION</span> <span class="n">StartOrder</span><span class="p">;</span>
<a name="rest_code_9d575ec96143499b9e79f1f35eff9603-7"></a><span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">OrderItems</span><span class="p">(</span><span class="n">order_num</span><span class="p">,</span> <span class="n">order_item</span><span class="p">,</span> <span class="n">prod_id</span><span class="p">,</span> <span class="n">quantity</span><span class="p">,</span> <span class="n">item_price</span><span class="p">)</span>
<a name="rest_code_9d575ec96143499b9e79f1f35eff9603-8"></a><span class="n">VALUES</span><span class="p">(</span><span class="mi">20100</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'BR01'</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mf">5.49</span><span class="p">);</span>
<a name="rest_code_9d575ec96143499b9e79f1f35eff9603-9"></a><span class="n">IF</span> <span class="err">@</span><span class="nd">@ERROR</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span> <span class="n">ROLLBACK</span> <span class="n">TRANSACTION</span> <span class="n">StartOrder</span><span class="p">;</span>
<a name="rest_code_9d575ec96143499b9e79f1f35eff9603-10"></a><span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">OrderItems</span><span class="p">(</span><span class="n">order_num</span><span class="p">,</span> <span class="n">order_item</span><span class="p">,</span> <span class="n">prod_id</span><span class="p">,</span> <span class="n">quantity</span><span class="p">,</span> <span class="n">item_price</span><span class="p">)</span> <span class="n">VALUES</span><span class="p">(</span><span class="mi">20100</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">'BR03'</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mf">10.99</span><span class="p">);</span>
<a name="rest_code_9d575ec96143499b9e79f1f35eff9603-11"></a><span class="n">IF</span> <span class="err">@</span><span class="nd">@ERROR</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span> <span class="n">ROLLBACK</span> <span class="n">TRANSACTION</span> <span class="n">StartOrder</span><span class="p">;</span>
<a name="rest_code_9d575ec96143499b9e79f1f35eff9603-12"></a><span class="n">COMMIT</span> <span class="n">TRANSACTION</span>
</pre>
</div>
</div>
</div>
<div class="section" id="using-cursors">
<h2>21.Using Cursors</h2>
<div class="section" id="working-with-cursors">
<h3>Working With Cursors</h3>
<div class="section" id="creating-cursors">
<h4>Creating Cursors</h4>
<pre class="code sql"><a name="rest_code_08578e2b5a824ffaa9016e5f1c889b6e-1"></a><span class="k">DECLARE</span> <span class="n">CustCursor</span> <span class="k">CURSOR</span>
<a name="rest_code_08578e2b5a824ffaa9016e5f1c889b6e-2"></a><span class="k">FOR</span>
<a name="rest_code_08578e2b5a824ffaa9016e5f1c889b6e-3"></a><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">Customers</span>
<a name="rest_code_08578e2b5a824ffaa9016e5f1c889b6e-4"></a><span class="k">WHERE</span> <span class="n">cust_email</span> <span class="k">IS</span> <span class="k">NULL</span>
</pre>
<pre class="code sql"><a name="rest_code_d8ac7ca4d1fa40acbf50d8bd59d3e6da-1"></a><span class="k">DECLARE</span> <span class="k">CURSOR</span> <span class="n">CustCursor</span>
<a name="rest_code_d8ac7ca4d1fa40acbf50d8bd59d3e6da-2"></a><span class="k">IS</span>
<a name="rest_code_d8ac7ca4d1fa40acbf50d8bd59d3e6da-3"></a><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">Customers</span> <span class="k">WHERE</span> <span class="n">cust_email</span> <span class="k">IS</span> <span class="k">NULL</span>
</pre>
</div>
<div class="section" id="id2">
<span id="using-cursors-1"></span><h4>Using Cursors</h4>
<pre class="code sql"><a name="rest_code_4b978b4ab2224adfb9e5635829a53929-1"></a><span class="k">DECLARE</span> <span class="k">TYPE</span> <span class="n">CustCursor</span> <span class="k">IS</span> <span class="k">REF</span> <span class="k">CURSOR</span>
<a name="rest_code_4b978b4ab2224adfb9e5635829a53929-2"></a>    <span class="k">RETURN</span> <span class="n">Customers</span><span class="o">%</span><span class="n">ROWTYPE</span><span class="p">;</span>
<a name="rest_code_4b978b4ab2224adfb9e5635829a53929-3"></a><span class="k">DECLARE</span> <span class="n">CustRecord</span> <span class="n">Customers</span><span class="o">%</span><span class="n">ROWTYPE</span>
<a name="rest_code_4b978b4ab2224adfb9e5635829a53929-4"></a><span class="k">BEGIN</span>
<a name="rest_code_4b978b4ab2224adfb9e5635829a53929-5"></a>    <span class="k">OPEN</span> <span class="n">CustCursor</span><span class="p">;</span>
<a name="rest_code_4b978b4ab2224adfb9e5635829a53929-6"></a>    <span class="k">FETCH</span> <span class="n">CustCursor</span> <span class="k">INTO</span> <span class="n">CustRecord</span><span class="p">;</span>
<a name="rest_code_4b978b4ab2224adfb9e5635829a53929-7"></a>    <span class="k">CLOSE</span> <span class="n">CustCursor</span><span class="p">;</span>
<a name="rest_code_4b978b4ab2224adfb9e5635829a53929-8"></a><span class="k">END</span><span class="p">;</span>
</pre>
<pre class="code sql"><a name="rest_code_eb4d361d171841768a4efe934a5d7593-1"></a>    <span class="k">DECLARE</span> <span class="k">TYPE</span> <span class="n">CustCursor</span> <span class="k">IS</span> <span class="k">REF</span> <span class="k">CURSOR</span>
<a name="rest_code_eb4d361d171841768a4efe934a5d7593-2"></a>        <span class="k">RETURN</span> <span class="n">Customers</span><span class="o">%</span><span class="n">ROWTYPE</span><span class="p">;</span>
<a name="rest_code_eb4d361d171841768a4efe934a5d7593-3"></a>    <span class="k">DECLARE</span> <span class="n">CustRecord</span> <span class="n">Customers</span><span class="o">%</span><span class="n">ROWTYPE</span>
<a name="rest_code_eb4d361d171841768a4efe934a5d7593-4"></a>    <span class="k">BEGIN</span>
<a name="rest_code_eb4d361d171841768a4efe934a5d7593-5"></a>        <span class="k">OPEN</span> <span class="n">CustCursor</span><span class="p">;</span>
<a name="rest_code_eb4d361d171841768a4efe934a5d7593-6"></a>        <span class="n">LOOP</span>
<a name="rest_code_eb4d361d171841768a4efe934a5d7593-7"></a>        <span class="k">FETCH</span> <span class="n">CustCursor</span> <span class="k">INTO</span> <span class="n">CustRecord</span><span class="p">;</span>
<a name="rest_code_eb4d361d171841768a4efe934a5d7593-8"></a>        <span class="n">EXIT</span> <span class="k">WHEN</span> <span class="n">CustCursor</span><span class="o">%</span><span class="n">NOTFOUND</span><span class="p">;</span>
<a name="rest_code_eb4d361d171841768a4efe934a5d7593-9"></a>        <span class="p">...</span>
<a name="rest_code_eb4d361d171841768a4efe934a5d7593-10"></a><span class="p">.</span>        <span class="k">END</span> <span class="n">LOOP</span><span class="p">;</span>
<a name="rest_code_eb4d361d171841768a4efe934a5d7593-11"></a>        <span class="k">CLOSE</span> <span class="n">CustCursor</span><span class="p">;</span>
</pre>
</div>
<div class="section" id="closing-cursors">
<h4>Closing Cursors</h4>
<pre class="code sql"><a name="rest_code_28028eb4855a41baac1c977886e722fb-1"></a><span class="k">CLOSE</span> <span class="n">CustCursor</span>
</pre>
<p>Here's the Microsoft SQL Server version:</p>
<pre class="code sql"><a name="rest_code_effd810782b04a5b8799dfec202a6252-1"></a><span class="k">CLOSE</span> <span class="n">CustCursor</span>
<a name="rest_code_effd810782b04a5b8799dfec202a6252-2"></a><span class="k">DEALLOCATE</span> <span class="k">CURSOR</span> <span class="n">CustCursor</span>
</pre>
<p>The CLOSE statement is used to close cursors; once a cursor is closed, it cannot be reused without being opened again. However, a cursor does not need to be declared again to be used; an OPEN is sufficient.</p>
</div>
</div>
</div>
<div class="section" id="understanding-advanced-sql-features">
<h2>22.Understanding Advanced SQL Features</h2>
<div class="section" id="understanding-constraints">
<h3>Understanding Constraints</h3>
<div class="section" id="id3">
<span id="primary-keys-1"></span><h4>Primary Keys</h4>
<div class="figure">
<img alt="Screen Shot 2018-08-13 at 10.28.19 PM" src="http://heropublic.oss-cn-beijing.aliyuncs.com/142840.png"><p class="caption">Screen Shot 2018-08-13 at 10.28.19 PM</p>
</div>
<pre class="code python"><a name="rest_code_f77c3acbc1e745bdb175d25ffcd44a97-1"></a><span class="n">ALTER</span> <span class="n">TABLE</span> <span class="n">Vendors</span>
<a name="rest_code_f77c3acbc1e745bdb175d25ffcd44a97-2"></a><span class="n">ADD</span> <span class="n">CONSTRAINT</span> <span class="n">PRIMARY</span> <span class="n">KEY</span> <span class="p">(</span><span class="n">vend_id</span><span class="p">);</span>
</pre>
</div>
<div class="section" id="foreign-keys">
<h4>Foreign Keys</h4>
<pre class="code python"><a name="rest_code_1727c105a11f4f769a183fedc5a6fca5-1"></a><span class="n">MySQL</span> <span class="p">[</span><span class="n">distributor</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">create</span> <span class="n">table</span> <span class="n">oorders</span> <span class="p">(</span> <span class="n">order_num</span> <span class="n">integer</span> <span class="ow">not</span> <span class="n">null</span> <span class="n">primary</span> <span class="n">key</span><span class="p">,</span> <span class="n">order_date</span> <span class="n">datetime</span> <span class="ow">not</span> <span class="n">null</span><span class="p">,</span> <span class="n">cust_id</span> <span class="n">char</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="ow">not</span> <span class="n">null</span> <span class="n">references</span> <span class="n">customers</span><span class="p">(</span><span class="n">cust_id</span><span class="p">)</span> <span class="p">);</span>
<a name="rest_code_1727c105a11f4f769a183fedc5a6fca5-2"></a><span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="n">affected</span> <span class="p">(</span><span class="mf">0.157</span> <span class="n">sec</span><span class="p">)</span>
</pre>
<pre class="code sql"><a name="rest_code_f7213c241c694b93b77cd2d7decd7186-1"></a><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">Orders</span>
<a name="rest_code_f7213c241c694b93b77cd2d7decd7186-2"></a><span class="k">ADD</span> <span class="k">CONSTRAINT</span>
<a name="rest_code_f7213c241c694b93b77cd2d7decd7186-3"></a><span class="k">FOREIGN</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">cust_id</span><span class="p">)</span> <span class="k">REFERENCES</span> <span class="n">Customers</span> <span class="p">(</span><span class="n">cust_id</span><span class="p">)</span>
</pre>
<p>#+BEGIN<sub>QUOTE</sub></p>
</div>
<div class="section" id="unique-constraints">
<h4>Unique Constraints</h4>
<pre class="code sql"><a name="rest_code_a6b67f7996d74f94bea5475b273a7e11-1"></a><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">OrderItems</span>
<a name="rest_code_a6b67f7996d74f94bea5475b273a7e11-2"></a><span class="p">(</span>
<a name="rest_code_a6b67f7996d74f94bea5475b273a7e11-3"></a>    <span class="n">order_num</span> <span class="nb">INTEGER</span>
<a name="rest_code_a6b67f7996d74f94bea5475b273a7e11-4"></a>    <span class="n">order_item</span> <span class="nb">INTEGER</span>
<a name="rest_code_a6b67f7996d74f94bea5475b273a7e11-5"></a>    <span class="n">prod_id</span> <span class="nb">CHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="n">quantity</span> <span class="nb">INTEGER</span> <span class="mi">0</span><span class="p">),</span>
<a name="rest_code_a6b67f7996d74f94bea5475b273a7e11-6"></a>   <span class="n">item_price</span> <span class="n">MONEY</span> <span class="p">);</span>
</pre>
</div>
</div>
<div class="section" id="understanding-indexes">
<h3>Understanding Indexes</h3>
<p>The following statement creates a simple index on the Products table's product name column:</p>
<pre class="code sql"><a name="rest_code_adced2a565e7428a9cc06f5956f115a5-1"></a><span class="k">CREATE</span> <span class="k">INDEX</span> <span class="n">prod_name_ind</span>
<a name="rest_code_adced2a565e7428a9cc06f5956f115a5-2"></a><span class="k">ON</span> <span class="n">PRODUCTS</span> <span class="p">(</span><span class="n">prod_name</span><span class="p">);</span>
</pre>
<p>Every index must be uniquely named. Here the name prod<sub>nameind</sub> is defined after the keywords CREATE INDEX. ON is used to specify the table being indexed, and the columns to include in the index (just one in this example) are specified in parentheses after the table name.</p>
<blockquote>
<p><strong>Tip: Revisiting Indexes</strong></p>
<p>Index effectiveness changes as table data is added or changed. Many database administrators find that what once was an ideal set of indexes might not be so ideal after several months of data manipulation. It is always a good idea to revisit indexes on a regular basis to fine-tune them as needed.</p>
</blockquote>
</div>
<div class="section" id="understanding-triggers">
<h3>Understanding Triggers</h3>
<p>Triggers are special stored procedures that are executed automatically when specific database activity occurs. Triggers might be associated with <strong>INSERT, UPDATE, and DELETE operations</strong> (or any combination thereof) on specific tables.</p>
<p>Unlike stored procedures (which are simply stored SQL statements), triggers are tied to individual tables. A trigger associated with INSERT operations on the Orders table will be executed only when a row is inserted into the Orders table. Similarly, a trigger on INSERT and UPDATE operations on the Customers table will be executed only when those specific operations occur on that table.</p>
<p>Within triggers, your code has access to the following:</p>
<ol class="arabic simple">
<li><p>All new data in INSERT operations</p></li>
<li><p>All new data and old data in UPDATE operations</p></li>
<li><p>Deleted data in DELETE operations</p></li>
</ol>
<p>Depending on the DBMS being used, triggers can be executed before or after a specified operation is performed.</p>
<p>The following are some common uses for Triggers:</p>
<ol class="arabic simple">
<li><p>Ensuring data consistency—For example, converting all state names to uppercase during an INSERT or UPDATE operation</p></li>
<li><p>Performing actions on other tables based on changes to a table—For example, writing an audit trail record to a log table each time a row is updated or deleted</p></li>
<li><p>Performing additional validation and rolling back data if needed—For example, making sure a customer's available credit has not been exceeded and blocking the insertion if it has</p></li>
<li><p>Calculating computed column values or updating timestamps As you probably expect by now, trigger creation syntax varies dramatically from one DBMS to another. Check your documentation for more details.</p></li>
</ol>
<p>As you probably expect by now, trigger creation syntax varies dramatically from one DBMS to another. Check your documentation for more details.</p>
<p>The following example creates a trigger that converts the cust<sub>state</sub> column in the Customers table to uppercase on all INSERT and UPDATE operations.</p>
<p>This is the SQL Server version:</p>
<pre class="code sql"><a name="rest_code_e7bd7dfb8ca847cbad75310e99a0514d-1"></a><span class="k">CREATE</span> <span class="k">TRIGGER</span> <span class="n">customer_state</span>
<a name="rest_code_e7bd7dfb8ca847cbad75310e99a0514d-2"></a><span class="k">ON</span> <span class="n">Customers</span>
<a name="rest_code_e7bd7dfb8ca847cbad75310e99a0514d-3"></a><span class="k">FOR</span> <span class="k">INSERT</span><span class="p">,</span> <span class="k">UPDATE</span>
<a name="rest_code_e7bd7dfb8ca847cbad75310e99a0514d-4"></a><span class="k">AS</span>
<a name="rest_code_e7bd7dfb8ca847cbad75310e99a0514d-5"></a><span class="k">UPDATE</span> <span class="n">Customers</span>
<a name="rest_code_e7bd7dfb8ca847cbad75310e99a0514d-6"></a><span class="k">SET</span> <span class="n">cust_state</span> <span class="o">=</span> <span class="k">Upper</span><span class="p">(</span><span class="n">cust_state</span><span class="p">)</span>
<a name="rest_code_e7bd7dfb8ca847cbad75310e99a0514d-7"></a><span class="k">WHERE</span> <span class="n">Customers</span><span class="p">.</span><span class="n">cust_id</span> <span class="o">=</span> <span class="n">inserted</span><span class="p">.</span><span class="n">cust_id</span><span class="p">;</span>
</pre>
<p>This is the Oracle and PostgreSQL version:</p>
<pre class="code sql"><a name="rest_code_446ca85515c04eb0a5a01c2cea058b01-1"></a><span class="k">CREATE</span> <span class="k">TRIGGER</span> <span class="n">customer_state</span>
<a name="rest_code_446ca85515c04eb0a5a01c2cea058b01-2"></a><span class="k">AFTER</span> <span class="k">INSERT</span> <span class="k">OR</span> <span class="k">UPDATE</span>
<a name="rest_code_446ca85515c04eb0a5a01c2cea058b01-3"></a><span class="k">FOR</span> <span class="k">EACH</span> <span class="k">ROW</span>
<a name="rest_code_446ca85515c04eb0a5a01c2cea058b01-4"></a><span class="k">BEGIN</span>
<a name="rest_code_446ca85515c04eb0a5a01c2cea058b01-5"></a><span class="k">UPDATE</span> <span class="n">Customers</span>
<a name="rest_code_446ca85515c04eb0a5a01c2cea058b01-6"></a><span class="k">SET</span> <span class="n">cust_state</span> <span class="o">=</span> <span class="k">Upper</span><span class="p">(</span><span class="n">cust_state</span><span class="p">)</span>
<a name="rest_code_446ca85515c04eb0a5a01c2cea058b01-7"></a><span class="k">WHERE</span> <span class="n">Customers</span><span class="p">.</span><span class="n">cust_id</span> <span class="o">=</span> <span class="p">:</span><span class="k">OLD</span><span class="p">.</span><span class="n">cust_id</span>
<a name="rest_code_446ca85515c04eb0a5a01c2cea058b01-8"></a><span class="k">END</span><span class="p">;</span>
</pre>
<!--  -->
<blockquote>
<p><strong>Tip: Constraints Are Faster Than Triggers</strong></p>
<p>As a rule, constraints are processed more quickly than triggers, so whenever possible, use constraints instead.</p>
</blockquote>
</div>
<div class="section" id="database-security">
<h3>Database Security</h3>
<p>There is nothing more valuable to an organization than its data, and data should always be protected from would-be thieves or casual browsers. Of course, at the same time data must be accessible to users who need access to it, and so most DBMSs provide administrators with mechanisms by which to grant or restrict access to data.</p>
<p>The foundation of any security system is user authorization and authentication. This is the process by which a user is validated to ensure he is who he says he is and that he is allowed to perform the operation he is trying to perform. Some DBMSs integrate with operating system security for this, others maintain their own user and password lists, and still others integrate with external directory services servers.</p>
<p>Some operations that are often secured</p>
<ol class="arabic simple">
<li><p>Access to database administration features (creating tables, altering or dropping existing tables, and so on)</p></li>
<li><p>Access to specific databases or tables</p></li>
<li><p>The type of access (read-only, access to specific columns, and so on)</p></li>
<li><p>Access to tables via views or stored procedures only</p></li>
<li><p>Creation of multiple levels of security, thus allowing varying degrees of access and control based on login</p></li>
<li><p>Restricting the ability to manage user accounts</p></li>
</ol>
<p>Security is managed via the SQL GRANT and REVOKE statements, although most DBMSs provide interactive administration utilities that use the GRANT and REVOKE statements internally.</p>
</div>
<div class="section" id="id4">
<span id="summary-1"></span><h3>Summary</h3>
<p>In this lesson, you learned how to use some advanced SQL features. Constraints are an important part of enforcing referential integrity; indexes can improve data retrieval performance; triggers can be used to perform pre- or post-execution processing; and security options can be used to manage data access. Your own DBMS probably offers some form of these features. Refer to your DBMS documentation for more details.</p>
</div>
</div>
<div class="section" id="appendix-c-sql-statement-syntax">
<h2>Appendix C. SQL Statement Syntax</h2>
<p>To help you find the syntax you need when you need it, this appendix lists the syntax for the most frequently used SQL operations. Each statement starts with a brief description and then displays the appropriate syntax. For added convenience, you'll also find cross references to the lessons where specific statements are taught.</p>
<p>When reading statement syntax, remember the following:</p>
<ul class="simple">
<li><p>The <code class="docutils literal">|</code> symbol is used to indicate one of several options, so <code class="docutils literal">NULL|NOT NULL</code> means specify either <code class="docutils literal">NULL</code> or <code class="docutils literal">NOT NULL</code>.</p></li>
<li><p>Keywords or clauses contained within square parentheses <code class="docutils literal">[like this]</code> are optional.</p></li>
<li><p>The syntax listed below will work with almost all DBMSs. You are advised to consult your own DBMS documentation for details of implementing specific syntactical changes.</p></li>
</ul>
<div class="section" id="alter-table">
<h3>ALTER TABLE</h3>
<p><code class="docutils literal">ALTER TABLE</code> is used to update the schema of an existing table. To create a new table, use <code class="docutils literal">CREATE TABLE</code>. See <a class="reference external" href="part0024.html#ch17">Lesson 17</a>, “<a class="reference external" href="part0024.html#ch17">Creating and Manipulating Tables</a>,” for more information.</p>
<p>Input</p>
<hr class="docutils">
<p>ALTER TABLE tablename (   ADD|DROP  column  datatype  [NULL|NOT NULL]  [CONSTRAINTS],   ADD|DROP  column  datatype  [NULL|NOT NULL]  [CONSTRAINTS],     … );</p>
</div>
<hr class="docutils">
<div class="section" id="commit">
<h3>COMMIT</h3>
<p><code class="docutils literal">COMMIT</code> is used to write a transaction to the database. See <a class="reference external" href="part0027.html#ch20">Lesson 20</a>, “[[<a class="reference external" href="file:part0027.html#ch20%5D%5BManaging">file:part0027.html#ch20][Managing</a> Transaction Processin],” for more information.</p>
<p>Input</p>
<hr class="docutils">
<p>COMMIT [TRANSACTION];</p>
</div>
<hr class="docutils">
<div class="section" id="create-index">
<h3>CREATE INDEX</h3>
<p><code class="docutils literal">CREATE INDEX</code> is used to create an index on one or more columns. See <a class="reference external" href="part0029.html#ch22">Lesson 22</a>, “<a class="reference external" href="part0029.html#ch22">Understanding Advanced SQL Features</a>,” for more information.</p>
<p>Input</p>
<hr class="docutils">
<p>CREATE INDEX indexname ON tablename (column, …);</p>
</div>
<hr class="docutils">
<div class="section" id="create-procedure">
<h3>CREATE PROCEDURE</h3>
<p><code class="docutils literal">CREATE PROCEDURE</code> is used to create a stored procedure. See <a class="reference external" href="part0026.html#ch19">Lesson 19</a>, “<a class="reference external" href="part0026.html#ch19">Working with Stored Procedures</a>,” for more information. Oracle uses a different syntax as described in that lesson.</p>
<p>Input</p>
<hr class="docutils">
<p>[[<a class="reference external" href="file:part0057_split_001.html#p249pro01%5D%5BClick">file:part0057_split_001.html#p249pro01][Click</a> here to view code imag]</p>
<p>CREATE PROCEDURE procedurename [parameters] [options] AS SQL statement;</p>
</div>
<hr class="docutils">
<div class="section" id="create-table">
<h3>CREATE TABLE</h3>
<p><code class="docutils literal">CREATE TABLE</code> is used to create new database tables. To update the schema of an existing table, use <code class="docutils literal">ALTER TABLE</code>. See <a class="reference external" href="part0024.html#ch17">Lesson 17</a> for more information.</p>
<p>Input</p>
<hr class="docutils">
<p>CREATE TABLE tablename (     column    datatype    [NULL|NOT NULL]    [CONSTRAINTS],     column    datatype    [NULL|NOT NULL]    [CONSTRAINTS],        … );</p>
</div>
<hr class="docutils">
<div class="section" id="create-view">
<h3>CREATE VIEW</h3>
<p><code class="docutils literal">CREATE VIEW</code> is used to create a new view of one or more tables. See <a class="reference external" href="part0025.html#ch18">Lesson 18</a>, “<a class="reference external" href="part0025.html#ch18">Using Views</a>,” for more information.</p>
<p>Input</p>
<hr class="docutils">
<p>CREATE VIEW viewname AS SELECT columns, … FROM tables, … [WHERE .. [GROUP BY .. [HAVING ..;</p>
</div>
<hr class="docutils">
<div class="section" id="delete">
<h3>DELETE</h3>
<p><code class="docutils literal">DELETE</code> deletes one or more rows from a table. See <a class="reference external" href="part0023.html#ch16">Lesson 16</a>,</p>
<p>Input</p>
<hr class="docutils">
<p>DELETE FROM tablename [WHERE ..;</p>
</div>
<hr class="docutils">
<div class="section" id="drop">
<h3>DROP</h3>
<p><code class="docutils literal">DROP</code> permanently removes database objects (tables, views, indexes, and so forth). See <a class="reference external" href="part0024.html#ch17">Lessons 17</a> and <a class="reference external" href="part0025.html#ch18">18</a> for more information.</p>
<p>Input</p>
<hr class="docutils">
<p>DROP INDEX|PROCEDURE|TABLE|VIEW indexname|procedurename|tablename|viewname;</p>
</div>
<hr class="docutils">
<div class="section" id="insert">
<h3>INSERT</h3>
<p><code class="docutils literal">INSERT</code> adds a single row to a table. See <a class="reference external" href="part0022.html#ch15">Lesson 15</a>,</p>
<hr class="docutils">
<p>INSERT INTO tablename [(columns, …)] VALUES(values, …);</p>
</div>
<hr class="docutils">
<div class="section" id="insert-select">
<h3>INSERT SELECT</h3>
<p><code class="docutils literal">INSERT SELECT</code> inserts the results of a <code class="docutils literal">SELECT</code> into a table. See <a class="reference external" href="part0022.html#ch15">Lesson 15</a> for more information.</p>
<hr class="docutils">
<p>INSERT INTO tablename [(columns, …)] SELECT columns, … FROM tablename, … [WHERE ..;</p>
</div>
<hr class="docutils">
<div class="section" id="rollback">
<h3>ROLLBACK</h3>
<p><code class="docutils literal">ROLLBACK</code> is used to undo a transaction block. See <a class="reference external" href="part0027.html#ch20">Lesson 20</a> for more information.</p>
<p>Input</p>
<hr class="docutils">
<p>ROLLBACK [ TO savepointnam;</p>
<hr class="docutils">
<p>or</p>
<p>Input</p>
<hr class="docutils">
<p>ROLLBACK TRANSACTION;</p>
</div>
<hr class="docutils">
<div class="section" id="select">
<h3>SELECT</h3>
<p><code class="docutils literal">SELECT</code> is used to retrieve data from one or more tables (or views).</p>
<hr class="docutils">
<p>SELECT columnname, … FROM tablename, … [WHERE .. [UNION .. [GROUP BY .. [HAVING .. [ORDER BY ..;</p>
</div>
<hr class="docutils">
<div class="section" id="update">
<h3>UPDATE</h3>
<p><code class="docutils literal">UPDATE</code> updates one or more rows in a table. See <a class="reference external" href="part0023.html#ch16">Lesson 16</a> for more information.</p>
<p>Input</p>
<hr class="docutils">
<p>UPDATE tablename SET columname = value, … [WHERE ..;</p>
</div>
</div>
<hr class="docutils">
<div class="section" id="publish">
<h2>Publish</h2>
</div>
</div>
            
        
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="?",
            disqus_url="https://alinbxsorcerer.github.io/posts/sql-in-10-minutes/",
        disqus_title="\u8bc4\u6ce8:SQL in 10 Minutes \u603b\u7ed3",
        disqus_identifier="cache/posts/sql-in-10-minutes.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        

        </div>
    </div>

    
    <footer><div class="container">
            <div class="social">



                <div class="social-entry">
                    <a href="../../rss.xml" target="_blank">
                        <i class="fa fa-rss"></i> 
                    </a>
                </div>
            </div>
                <div class="copyright">
                    Contents © 2019         <a href="mailto:davad.fhl.wang@foxmail.com">David</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
                    
                </div>
           
        </div>
    </footer><script src="../../assets/js/all-nocdn.js" type="text/javascript"></script>
</body>
</html>
